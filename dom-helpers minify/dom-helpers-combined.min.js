/**
 * DOM Helpers - Combined Bundle (Unminified)
 * High-performance vanilla JavaScript DOM utilities with intelligent caching
 * 
 * Includes:
 * - Update Utility (Universal .update() method)
 * - Elements Helper (ID-based DOM access)
 * - Collections Helper (Class/Tag/Name-based DOM access)
 * - Selector Helper (querySelector/querySelectorAll with caching)
 * 
 * @version 2.1.0
 * @license MIT
 */
!function(e){"use strict";function t(e){if(!e||e._classListProtected)return e;const t=e.classList;try{Object.defineProperty(e,"classList",{get:function(){return t},set:function(e){"object"==typeof e&&null!==e&&Object.entries(e).forEach(([e,n])=>{switch(e){case"add":Array.isArray(n)?n.forEach(e=>t.add(e)):"string"==typeof n&&t.add(n);break;case"remove":Array.isArray(n)?n.forEach(e=>t.remove(e)):"string"==typeof n&&t.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(e=>t.toggle(e)):"string"==typeof n&&t.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&t.replace(n[0],n[1])}})},configurable:!1,enumerable:!0}),Object.defineProperty(e,"_classListProtected",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(e){console.warn("[DOM Helpers] Could not protect classList:",e.message)}return e}function n(e,t=!1){return function(n={}){return n&&"object"==typeof n?t?r(e,n):s(e,n):(console.warn("[DOM Helpers] .update() called with invalid updates object"),e)}}function s(e,t){if(!e||!e.nodeType)return console.warn("[DOM Helpers] .update() called on null or invalid element"),e;try{Object.entries(t).forEach(([t,n])=>{o(e,t,n)})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e}function r(e,t){if(!e)return console.warn("[DOM Helpers] .update() called on null collection"),e;let n=[];if(void 0!==e.length)n=Array.from(e);else if(e._originalCollection)n=Array.from(e._originalCollection);else{if(!e._originalNodeList)return console.warn("[DOM Helpers] .update() called on unrecognized collection type"),e;n=Array.from(e._originalNodeList)}if(0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{o(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e}function o(e,t,n){try{if("style"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)});if("classList"===t&&"object"==typeof n&&null!==n)return void l(e,n);if("setAttribute"===t)return void(Array.isArray(n)&&n.length>=2?e.setAttribute(n[0],n[1]):"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.setAttribute(t,n)}));if("removeAttribute"===t)return void(Array.isArray(n)?n.forEach(t=>e.removeAttribute(t)):"string"==typeof n&&e.removeAttribute(n));if("getAttribute"===t&&"string"==typeof n){const t=e.getAttribute(n);return void console.log(`[DOM Helpers] getAttribute('${n}'):`,t)}if("addEventListener"===t)return void i(e,n);if("removeEventListener"===t&&Array.isArray(n)&&n.length>=2){const[t,s,r]=n;return void e.removeEventListener(t,s,r)}if("dataset"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n});if("function"==typeof e[t])return void(Array.isArray(n)?e[t](...n):e[t](n));if(t in e)return void(e[t]=n);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void e.setAttribute(t,n);console.warn(`[DOM Helpers] Unknown property or method: ${t}`)}catch(e){console.warn(`[DOM Helpers] Failed to apply update ${t}: ${e.message}`)}}function i(e,t){if(Array.isArray(t)&&t.length>=2){const[n,s,r]=t,o=a(s);return void e.addEventListener(n,o,r)}"object"!=typeof t||null===t||Array.isArray(t)?console.warn("[DOM Helpers] Invalid addEventListener value format"):Object.entries(t).forEach(([t,n])=>{if("function"==typeof n){const s=a(n);e.addEventListener(t,s)}else if(Array.isArray(n)&&n.length>=1){const[s,r]=n;if("function"==typeof s){const n=a(s);e.addEventListener(t,n,r)}}})}function a(e){return function(t){return t.target&&!t.target.update&&c(t.target),this&&this.nodeType===Node.ELEMENT_NODE&&!this.update&&c(this),e.call(this,t)}}function l(e,t){Object.entries(t).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1]);break;case"contains":Array.isArray(n)?n.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof n&&console.log(`[DOM Helpers] classList.contains('${n}'):`,e.classList.contains(n));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}function c(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:n(e,!1),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=n(e,!1),e._hasEnhancedUpdateMethod=!0}return e}function u(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:n(e,!0),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=n(e,!0),e._hasEnhancedUpdateMethod=!0}return e}function h(e){return e&&(void 0!==e.length||e._originalCollection||e._originalNodeList||e instanceof NodeList||e instanceof HTMLCollection)}const d={createEnhancedUpdateMethod:n,enhanceElementWithUpdate:c,enhanceCollectionWithUpdate:u,autoEnhanceWithUpdate:function(e){return e?h(e)?u(e):e.nodeType===Node.ELEMENT_NODE?c(e):e:e},isCollection:h,updateSingleElement:s,updateCollection:r,applyEnhancedUpdate:o,handleClassListUpdate:l,createUpdateExample:function(){return{textContent:"Enhanced Button",innerHTML:"<strong>Enhanced</strong> Button",id:"myEnhancedButton",className:"btn btn-primary",style:{color:"white",backgroundColor:"#007bff",padding:"10px 20px",border:"none",borderRadius:"5px"},classList:{add:["fancy","highlight"],remove:["old-class"],toggle:"active",replace:["btn-old","btn-new"]},setAttribute:["data-role","button"],removeAttribute:"disabled",dataset:{userId:"123",action:"submit"},addEventListener:["click",e=>{console.log("Button clicked!",e),e.target.classList.toggle("clicked")}],focus:[],scrollIntoView:[{behavior:"smooth"}]}}};let p;if("undefined"!=typeof module&&module.exports?module.exports=d:"function"==typeof define&&define.amd?define([],function(){return d}):e.EnhancedUpdateUtility=d,"undefined"!=typeof require)try{p=require("./update-utility.js")}catch(e){}else void 0!==e&&e.UpdateUtility&&(p=e.UpdateUtility);class f{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Elements=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getElement(t),has:(e,t)=>e._hasElement(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasElement(t))return{enumerable:!0,configurable:!0,value:e._getElement(t)}}})}_getElement(e){if("string"!=typeof e)return this._warn("Invalid element property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,this._enhanceElementWithUpdate(t);this.cache.delete(e)}const t=document.getElementById(e);return t?(this._addToCache(e,t),this.stats.misses++,this._enhanceElementWithUpdate(t)):(this.stats.misses++,this.options.enableLogging&&this._warn(`Element with id '${e}' not found`),null)}_hasElement(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}return!!document.getElementById(e)}_getKeys(){const e=document.querySelectorAll("[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{id:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&t.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&t.add(e.id)})}catch(e){}}}),e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&n.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&n.add(e.id)})}catch(e){}}}),"attributes"===e.type&&"id"===e.attributeName){const s=e.oldValue,r=e.target.id;s&&s!==r&&n.add(s),r&&r!==s&&t.add(r)}}),t.forEach(e=>{const t=document.getElementById(e);t&&this._addToCache(e,t)}),n.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)&&n.id===t||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Elements] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Elements] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(t(e),d&&d.enhanceElementWithUpdate)return d.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{if("style"!==t||"object"!=typeof n||null===n)if("classList"!==t||"object"!=typeof n||null===n)if("setAttribute"!==t)if("removeAttribute"!==t)if("dataset"!==t||"object"!=typeof n||null===n)if("addEventListener"!==t){if("removeEventListener"===t&&Array.isArray(n)&&n.length>=2){const[t,s,r]=n;return void e.removeEventListener(t,s,r)}"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n)}else i(e,n);else Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n});else Array.isArray(n)?n.forEach(t=>e.removeAttribute(t)):"string"==typeof n&&e.removeAttribute(n);else Array.isArray(n)&&n.length>=2?e.setAttribute(n[0],n[1]):"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.setAttribute(t,n)});else Object.entries(n).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}});else Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"classList"!==t||"object"!=typeof n||null===n?"setAttribute"!==t?"addEventListener"!==t?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):i(e,n):Array.isArray(n)&&n.length>=2?e.setAttribute(n[0],n[1]):"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.setAttribute(t,n)}):Object.entries(n).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}}):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Elements helper destroyed")}isCached(e){return this.cache.has(e)}getCacheSnapshot(){return Array.from(this.cache.keys())}destructure(...e){const t={},n=[];return e.forEach(e=>{const s=this.Elements[e];s?t[e]=s:(n.push(e),t[e]=null)}),n.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${n.join(", ")}`),t}getRequired(...e){const t=this.destructure(...e),n=e.filter(e=>!t[e]);if(n.length>0)throw new Error(`Required elements not found: ${n.join(", ")}`);return t}async waitFor(...e){const t=Date.now();for(;Date.now()-t<5e3;){const t=this.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)}get(e,t=null){return this.Elements[e]||t}exists(e){return!!this.Elements[e]}getMultiple(...e){return this.destructure(...e)}setProperty(e,t,n){const s=this.Elements[e];return!(!s||!(t in s))&&(s[t]=n,!0)}getProperty(e,t,n=void 0){const s=this.Elements[e];return s&&t in s?s[t]:n}setAttribute(e,t,n){const s=this.Elements[e];return!!s&&(s.setAttribute(t,n),!0)}getAttribute(e,t,n=null){const s=this.Elements[e];return s&&s.getAttribute(t)||n}}const m=new f({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),y=m.Elements;y.helper=m,y.stats=()=>m.getStats(),y.clear=()=>m.clearCache(),y.destroy=()=>m.destroy(),y.destructure=(...e)=>m.destructure(...e),y.getRequired=(...e)=>m.getRequired(...e),y.waitFor=(...e)=>m.waitFor(...e),y.isCached=e=>m.isCached(e),y.get=(e,t)=>m.get(e,t),y.exists=e=>m.exists(e),y.getMultiple=(...e)=>m.getMultiple(...e),y.setProperty=(e,t,n)=>m.setProperty(e,t,n),y.getProperty=(e,t,n)=>m.getProperty(e,t,n),y.setAttribute=(e,t,n)=>m.setAttribute(e,t,n),y.getAttribute=(e,t,n)=>m.getAttribute(e,t,n),y.configure=e=>(Object.assign(m.options,e),y),"undefined"!=typeof module&&module.exports?module.exports={Elements:y,ProductionElementsHelper:f}:"function"==typeof define&&define.amd?define([],function(){return{Elements:y,ProductionElementsHelper:f}}):(e.Elements=y,e.ProductionElementsHelper=f),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{m.destroy()});class g{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_initProxies(){this.ClassName=this._createCollectionProxy("className"),this.TagName=this._createCollectionProxy("tagName"),this.Name=this._createCollectionProxy("name")}_createCollectionProxy(e){return new Proxy(t=>{const n=this._getCollection(e,t);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(n):n},{get:(t,n)=>{if("symbol"==typeof n||"constructor"===n||"prototype"===n||"apply"===n||"call"===n||"bind"===n||"function"==typeof t[n])return t[n];const s=this._getCollection(e,n);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(s):s},apply:(e,t,n)=>n.length>0?e(n[0]):this._createEmptyCollection()})}_createEnhancedCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set element property ${t}: ${e.message}`),!1}}}):e}_createCacheKey(e,t){return`${e}:${t}`}_getCollection(e,t){if("string"!=typeof t)return this._warn(`Invalid ${e} property type: ${typeof t}`),this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const e=this.cache.get(n);if(this._isValidCollection(e))return this.stats.hits++,e;this.cache.delete(n)}let s;try{switch(e){case"className":s=document.getElementsByClassName(t);break;case"tagName":s=document.getElementsByTagName(t);break;case"name":s=document.getElementsByName(t);break;default:return this._warn(`Unknown collection type: ${e}`),this._createEmptyCollection()}}catch(n){return this._warn(`Error getting ${e} collection for "${t}": ${n.message}`),this._createEmptyCollection()}const r=this._enhanceCollection(s,e,t);return this._addToCache(n,r),this.stats.misses++,r}_isValidCollection(e){if(!e||!e._originalCollection)return!1;const t=e._originalCollection;if(0===t.length)return!0;const n=t[0];return n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)}_enhanceCollection(e,t,n){const s={_originalCollection:e,_type:t,_value:n,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),namedItem:t=>e.namedItem?e.namedItem(t):null,toArray:()=>Array.from(e),forEach(t,n){Array.from(e).forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))}};for(let t=0;t<e.length;t++)Object.defineProperty(s,t,{get:()=>e[t],enumerable:!0});return s[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(s)}_createEmptyCollection(){return this._enhanceCollection({length:0,item:()=>null,namedItem:()=>null},"empty","")}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set,s=new Set;e.forEach(e=>{if([...e.addedNodes,...e.removedNodes].forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase());try{(e.querySelectorAll?e.querySelectorAll("*"):[]).forEach(e=>{e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase())})}catch(e){}}}),"attributes"===e.type){const s=e.target;if("class"===e.attributeName){[...e.oldValue?e.oldValue.split(/\s+/):[],...s.className?s.className.split(/\s+/):[]].forEach(e=>{e&&t.add(e)})}"name"===e.attributeName&&(e.oldValue&&n.add(e.oldValue),s.name&&n.add(s.name))}});const r=[];for(const e of this.cache.keys()){const[o,i]=e.split(":",2);("className"===o&&t.has(i)||"name"===o&&n.has(i)||"tagName"===o&&s.has(i))&&r.push(e)}r.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,r.length>0&&this.options.enableLogging&&this._log(`Invalidated ${r.length} cache entries due to DOM changes`)}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)this._isValidCollection(n)||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Collections] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Collections] ${e}`)}_applyEnhancedUpdateToElement(e,t,n){try{if("style"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)});if("classList"===t&&"object"==typeof n&&null!==n)return void this._handleClassListUpdate(e,n);if("setAttribute"===t&&Array.isArray(n)&&n.length>=2)return void e.setAttribute(n[0],n[1]);if("removeAttribute"===t)return void(Array.isArray(n)?n.forEach(t=>e.removeAttribute(t)):"string"==typeof n&&e.removeAttribute(n));if("addEventListener"===t)return void i(e,n);if("removeEventListener"===t&&Array.isArray(n)&&n.length>=2){const[t,s,r]=n;return void e.removeEventListener(t,s,r)}if("dataset"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n});if("function"==typeof e[t])return void(Array.isArray(n)?e[t](...n):e[t](n));if(t in e)return void(e[t]=n);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void e.setAttribute(t,n);console.warn(`[DOM Helpers] Unknown property or method: ${t}`)}catch(e){console.warn(`[DOM Helpers] Failed to apply update ${t}: ${e.message}`)}}_handleClassListUpdate(e,t){Object.entries(t).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1]);break;case"contains":Array.isArray(n)?n.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof n&&console.log(`[DOM Helpers] classList.contains('${n}'):`,e.classList.contains(n));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(e._originalCollection&&Array.from(e._originalCollection).forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&t(e)}),d&&d.enhanceCollectionWithUpdate)return d.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{this._applyEnhancedUpdateToElement(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{this._applyEnhancedUpdateToElement(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasEnhancedUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Collections helper destroyed")}isCached(e,t){return this.cache.has(this._createCacheKey(e,t))}getCacheSnapshot(){return Array.from(this.cache.keys())}getMultiple(e){const t={};return e.forEach(({type:e,value:n,as:s})=>{const r=s||`${e}_${n}`;switch(e){case"className":t[r]=this.ClassName[n];break;case"tagName":t[r]=this.TagName[n];break;case"name":t[r]=this.Name[n]}}),t}async waitForElements(e,t,n=1,s=5e3){const r=Date.now();for(;Date.now()-r<s;){let s;switch(e){case"className":s=this.ClassName[t];break;case"tagName":s=this.TagName[t];break;case"name":s=this.Name[t];break;default:throw new Error(`Unknown collection type: ${e}`)}if(s&&s.length>=n)return s;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for ${e}="${t}" (min: ${n})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this}}const b=new g({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableEnhancedSyntax:!0}),E={ClassName:b.ClassName,TagName:b.TagName,Name:b.Name,helper:b,stats:()=>b.getStats(),clear:()=>b.clearCache(),destroy:()=>b.destroy(),isCached:(e,t)=>b.isCached(e,t),getMultiple:e=>b.getMultiple(e),waitFor:(e,t,n,s)=>b.waitForElements(e,t,n,s),enableEnhancedSyntax:()=>b.enableEnhancedSyntax(),disableEnhancedSyntax:()=>b.disableEnhancedSyntax(),configure:e=>(Object.assign(b.options,e),E)};"undefined"!=typeof module&&module.exports?module.exports={Collections:E,ProductionCollectionHelper:g}:"function"==typeof define&&define.amd?define([],function(){return{Collections:E,ProductionCollectionHelper:g}}):(e.Collections=E,e.ProductionCollectionHelper=g),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{b.destroy()});class v{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableSmartCaching:e.enableSmartCaching??!0,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now(),selectorTypes:new Map},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this.selectorPatterns=this._buildSelectorPatterns(),this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_buildSelectorPatterns(){return{id:/^#([a-zA-Z][\w-]*)$/,class:/^\.([a-zA-Z][\w-]*)$/,tag:/^([a-zA-Z][a-zA-Z0-9]*)$/,attribute:/^\[([^\]]+)\]$/,descendant:/^(\w+)\s+(\w+)$/,child:/^(\w+)\s*>\s*(\w+)$/,pseudo:/^(\w+):([a-zA-Z-]+)$/}}_initProxies(){this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this.options.enableEnhancedSyntax&&this._initEnhancedSyntax(),this.Scoped={within:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return null;const s=`scoped:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"single",s)},withinAll:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return this._createEmptyCollection();const s=`scopedAll:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"multiple",s)}}}_initEnhancedSyntax(){const e=this.query;this.query=new Proxy(e,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("single",n);return s?this._createElementProxy(s):s},apply:(e,t,n)=>n.length>0?this._getQuery("single",n[0]):null});const t=this.queryAll;this.queryAll=new Proxy(t,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("multiple",n);return this._createCollectionProxy(s)},apply:(e,t,n)=>n.length>0?this._getQuery("multiple",n[0]):this._createEmptyCollection()})}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set property ${t}: ${e.message}`),!1}}}):e}_createCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createQueryFunction(e){const t=t=>this._getQuery(e,t);return t._queryType=e,t._helper=this,t}_normalizeSelector(e){const t=e.toString(),n=e=>`#${this._camelToKebab(e)}`,s=e=>`.${this._camelToKebab(e)}`;return t.startsWith("id")&&t.length>2?n(t.slice(2)):t.startsWith("class")&&t.length>5?s(t.slice(5)):/^[a-z][a-zA-Z]*$/.test(t)&&/[A-Z]/.test(t)?s(t):/^[a-z]+$/.test(t)&&t.length<10?t:t.match(/^[a-zA-Z][\w-]*$/)?`#${t}`:t}_camelToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}_createCacheKey(e,t){return`${e}:${t}`}_getQuery(e,t){if("string"!=typeof t)return this._warn("Invalid selector type: "+typeof t),"single"===e?null:this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const s=this.cache.get(n);if(this._isValidQuery(s,e))return this.stats.hits++,this._trackSelectorType(t),s;this.cache.delete(n)}let s;try{if("single"===e){const e=document.querySelector(t);s=this._enhanceElementWithUpdate(e)}else{const e=document.querySelectorAll(t);s=this._enhanceNodeList(e,t)}}catch(n){return this._warn(`Invalid selector "${t}": ${n.message}`),"single"===e?null:this._createEmptyCollection()}return this._addToCache(n,s),this.stats.misses++,this._trackSelectorType(t),s}_getScopedQuery(e,t,n,s){if(this.cache.has(s)){const e=this.cache.get(s);if(this._isValidQuery(e,n))return this.stats.hits++,e;this.cache.delete(s)}let r;try{if("single"===n)r=e.querySelector(t);else{const n=e.querySelectorAll(t);r=this._enhanceNodeList(n,t)}}catch(e){return this._warn(`Invalid scoped selector "${t}": ${e.message}`),"single"===n?null:this._createEmptyCollection()}return this._addToCache(s,r),this.stats.misses++,r}_isValidQuery(e,t){if("single"===t)return e&&e.nodeType===Node.ELEMENT_NODE&&document.contains(e);{if(!e||!e._originalNodeList)return!1;const t=e._originalNodeList;if(0===t.length)return!0;const n=t[0];return n&&document.contains(n)}}_enhanceNodeList(e,t){const n={_originalNodeList:e,_selector:t,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),entries:()=>e.entries(),keys:()=>e.keys(),values:()=>e.values(),toArray:()=>Array.from(e),forEach(t,n){e.forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))},within(e){const t=[];return this.forEach(n=>{const s=n.querySelectorAll(e);t.push(...Array.from(s))}),this._helper._enhanceNodeList(t,`${this._selector} ${e}`)}};for(let t=0;t<e.length;t++)Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0});return n[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(n)}_createEmptyCollection(){const e=document.querySelectorAll("nonexistent-element-that-never-exists");return this._enhanceNodeList(e,"empty")}_trackSelectorType(e){const t=this._classifySelector(e),n=this.stats.selectorTypes.get(t)||0;this.stats.selectorTypes.set(t,n+1)}_classifySelector(e){return this.selectorPatterns.id.test(e)?"id":this.selectorPatterns.class.test(e)?"class":this.selectorPatterns.tag.test(e)?"tag":this.selectorPatterns.attribute.test(e)?"attribute":this.selectorPatterns.descendant.test(e)?"descendant":this.selectorPatterns.child.test(e)?"child":this.selectorPatterns.pseudo.test(e)?"pseudo":"complex"}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,t&&t.nodeType===Node.ELEMENT_NODE&&this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){if(!this.options.enableSmartCaching)return;const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set;if(e.forEach(e=>{if("childList"===e.type&&t.add("*"),"attributes"===e.type){const n=e.target,s=e.attributeName;if("id"===s){const s=e.oldValue;s&&t.add(`#${s}`),n.id&&t.add(`#${n.id}`)}if("class"===s){[...e.oldValue?e.oldValue.split(/\s+/):[],...n.className?n.className.split(/\s+/):[]].forEach(e=>{e&&t.add(`.${e}`)})}t.add(`[${s}]`)}}),t.has("*"))this.cache.clear();else{const e=[];for(const n of this.cache.keys()){const[s,r]=n.split(":",2);for(const s of t)if(r.includes(s)){e.push(n);break}}e.forEach(e=>this.cache.delete(e))}this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache){const[s]=t.split(":",1);this._isValidQuery(n,"single"===s?"single":"multiple")||e.push(t)}e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Selector] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Selector] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(t(e),d&&d.enhanceElementWithUpdate)return d.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(e._originalCollection&&Array.from(e._originalCollection).forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&t(e)}),d&&d.enhanceCollectionWithUpdate)return d.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup,selectorBreakdown:Object.fromEntries(this.stats.selectorTypes)}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this.stats.selectorTypes.clear(),this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Selector helper destroyed")}async waitForSelector(e,t=5e3){const n=Date.now();for(;Date.now()-n<t;){const t=this.query(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e}`)}async waitForSelectorAll(e,t=1,n=5e3){const s=Date.now();for(;Date.now()-s<n;){const n=this.queryAll(e);if(n&&n.length>=t)return n;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e} (min: ${t})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this._initEnhancedSyntax(),this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this}}const w=new v({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableSmartCaching:!0,enableEnhancedSyntax:!0}),_={query:w.query,queryAll:w.queryAll,Scoped:w.Scoped,helper:w,stats:()=>w.getStats(),clear:()=>w.clearCache(),destroy:()=>w.destroy(),waitFor:(e,t)=>w.waitForSelector(e,t),waitForAll:(e,t,n)=>w.waitForSelectorAll(e,t,n),enableEnhancedSyntax:()=>w.enableEnhancedSyntax(),disableEnhancedSyntax:()=>w.disableEnhancedSyntax(),configure:e=>(Object.assign(w.options,e),_)};"undefined"!=typeof module&&module.exports?module.exports={Selector:_,ProductionSelectorHelper:v}:"function"==typeof define&&define.amd?define([],function(){return{Selector:_,ProductionSelectorHelper:v}}):(e.Selector=_,e.ProductionSelectorHelper=v),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{w.destroy()});const C={Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper,version:"2.0.0",isReady(){return!!(this.Elements&&this.Collections&&this.Selector)},getStats(){const e={};return this.Elements&&"function"==typeof this.Elements.stats&&(e.elements=this.Elements.stats()),this.Collections&&"function"==typeof this.Collections.stats&&(e.collections=this.Collections.stats()),this.Selector&&"function"==typeof this.Selector.stats&&(e.selector=this.Selector.stats()),e},clearAll(){this.Elements&&"function"==typeof this.Elements.clear&&this.Elements.clear(),this.Collections&&"function"==typeof this.Collections.clear&&this.Collections.clear(),this.Selector&&"function"==typeof this.Selector.clear&&this.Selector.clear()},destroyAll(){this.Elements&&"function"==typeof this.Elements.destroy&&this.Elements.destroy(),this.Collections&&"function"==typeof this.Collections.destroy&&this.Collections.destroy(),this.Selector&&"function"==typeof this.Selector.destroy&&this.Selector.destroy()},configure(e={}){return this.Elements&&"function"==typeof this.Elements.configure&&this.Elements.configure(e.elements||e),this.Collections&&"function"==typeof this.Collections.configure&&this.Collections.configure(e.collections||e),this.Selector&&"function"==typeof this.Selector.configure&&this.Selector.configure(e.selector||e),this}};"undefined"!=typeof module&&module.exports?module.exports={DOMHelpers:C,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}:"function"==typeof define&&define.amd?define([],function(){return{DOMHelpers:C,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}}):e.DOMHelpers=C,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{C.destroyAll()}),function(){const e=document.createElement;document.createElement=function(t,n){const s=e.call(document,t,n);return c(s)},document.createElement.restore=function(){document.createElement=e}}()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Animation Module
 * Modular JavaScript Animations/Transitions helper that integrates seamlessly with DOM Helpers
 * 
 * Features:
 * - Declarative animation methods: fadeIn, fadeOut, slideUp, slideDown, slideToggle, transform
 * - Animation chaining support
 * - Configurable durations, delays, easing, and callbacks
 * - Compatible with .update({}) method from DOM Helpers
 * - Works with dynamic content (AJAX-loaded elements)
 * - Automatic cleanup of inline styles after animation completes
 * - Browser compatibility with graceful fallbacks
 * - Stays close to vanilla JavaScript using traditional DOM APIs
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";if(void 0===e.Elements&&"undefined"==typeof Elements)return void console.warn("[DOM Helpers Animation] Main DOM Helpers library must be loaded before the Animation module");const t={duration:300,delay:0,easing:"ease",cleanup:!0,queue:!0},n={linear:"linear",ease:"ease","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out","ease-in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","ease-out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","ease-in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","ease-in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","ease-out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","ease-in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","ease-in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","ease-out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","ease-in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","ease-in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","ease-out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","ease-in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","ease-in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","ease-out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","ease-in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","ease-in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","ease-out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","ease-in-out-expo":"cubic-bezier(1, 0, 0, 1)","ease-in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","ease-out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","ease-in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","ease-in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},s={transitions:function(){const e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(let n in t)if(void 0!==e.style[n])return{property:n,event:t[n]};return!1}(),transforms:function(){const e=document.createElement("div"),t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(let n=0;n<t.length;n++)if(void 0!==e.style[t[n]])return t[n];return!1}()};const r=new class{constructor(){this.queues=new WeakMap}add(e,t){this.queues.has(e)||this.queues.set(e,[]),this.queues.get(e).push(t),1===this.queues.get(e).length&&this.process(e)}process(e){const t=this.queues.get(e);if(!t||0===t.length)return;(0,t[0])().then(()=>{t.shift(),t.length>0&&this.process(e)}).catch(()=>{t.shift(),t.length>0&&this.process(e)})}clear(e){this.queues.has(e)&&this.queues.set(e,[])}isEmpty(e){const t=this.queues.get(e);return!t||0===t.length}};function o(e={}){const s={...t,...e};return"string"==typeof s.easing&&n[s.easing]&&(s.easing=n[s.easing]),s}function i(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function a(e,t){Object.entries(t).forEach(([t,n])=>{e.style[t]=n})}function l(e,t,n){const r=t.map(e=>`${e} ${n.duration}ms ${n.easing} ${n.delay}ms`).join(", ");s.transitions&&(e.style[s.transitions.property]=r)}function c(e,t){return new Promise(n=>{if(!s.transitions)return void setTimeout(n,t.duration+t.delay);let r=!1;const o=setTimeout(()=>{r||(r=!0,i(),n())},t.duration+t.delay+50),i=()=>{e.removeEventListener(s.transitions.event,a),clearTimeout(o)},a=t=>{t.target!==e||r||(r=!0,i(),n())};e.addEventListener(s.transitions.event,a)})}function u(e,t,n=[]){t.cleanup&&(s.transitions&&e.style.removeProperty(s.transitions.property),function(e,t){t.forEach(t=>{e.style.removeProperty(t)})}(e,n))}async function h(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{const s=i(e,"display");i(e,"opacity");"none"===s&&(e.style.display="block"),e.style.opacity="0",e.offsetHeight,l(e,["opacity"],n),e.style.opacity="1",await c(e,n),u(e,n,["opacity"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function d(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{i(e,"opacity");l(e,["opacity"],n),e.style.opacity="0",await c(e,n),!1!==n.hide&&(e.style.display="none"),u(e,n,!1!==n.hide?["opacity"]:[]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function p(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{const s=e.offsetHeight,r=i(e,"padding-top"),o=i(e,"padding-bottom"),h=i(e,"margin-top"),d=i(e,"margin-bottom");i(e,"overflow");a(e,{height:s+"px",paddingTop:r,paddingBottom:o,marginTop:h,marginBottom:d,overflow:"hidden"}),e.offsetHeight,l(e,["height","padding-top","padding-bottom","margin-top","margin-bottom"],n),a(e,{height:"0px",paddingTop:"0px",paddingBottom:"0px",marginTop:"0px",marginBottom:"0px"}),await c(e,n),e.style.display="none",u(e,n,["height","padding-top","padding-bottom","margin-top","margin-bottom","overflow"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function f(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{"none"===i(e,"display")&&(e.style.display="block");const s=e.offsetHeight,r=i(e,"padding-top"),o=i(e,"padding-bottom"),h=i(e,"margin-top"),d=i(e,"margin-bottom");a(e,{height:"0px",paddingTop:"0px",paddingBottom:"0px",marginTop:"0px",marginBottom:"0px",overflow:"hidden"}),e.offsetHeight,l(e,["height","padding-top","padding-bottom","margin-top","margin-bottom"],n),a(e,{height:s+"px",paddingTop:r,paddingBottom:o,marginTop:h,marginBottom:d}),await c(e,n),u(e,n,["height","padding-top","padding-bottom","margin-top","margin-bottom","overflow"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function m(e,t={}){const n=o(t);return"none"!==i(e,"display")&&e.offsetHeight>0?p(e,n):f(e,n)}async function y(e,t,n={}){const r=o(n);return new Promise(async(n,o)=>{try{if(!s.transforms)return console.warn("[DOM Helpers Animation] Transform not supported in this browser"),void setTimeout(()=>n(e),r.duration+r.delay);let o="";Object.entries(t).forEach(([e,t])=>{switch(e){case"translateX":case"translateY":case"translateZ":case"scale":case"scaleX":case"scaleY":case"scaleZ":case"rotate":case"rotateX":case"rotateY":case"rotateZ":case"skew":case"skewX":case"skewY":o+=`${e}(${t}) `;break;case"translate":Array.isArray(t)?o+=`translate(${t[0]}, ${t[1]}) `:o+=`translate(${t}) `;break;case"translate3d":Array.isArray(t)&&t.length>=3&&(o+=`translate3d(${t[0]}, ${t[1]}, ${t[2]}) `);break;default:console.warn(`[DOM Helpers Animation] Unknown transform property: ${e}`)}}),l(e,[s.transforms],r),e.style[s.transforms]=o.trim(),await c(e,r),r.cleanup&&u(e,r,[s.transforms]),"function"==typeof r.onComplete&&r.onComplete(e),n(e)}catch(e){o(e)}})}class g{constructor(e){this.element=e,this.animations=[]}fadeIn(e={}){return this.animations.push(()=>h(this.element,e)),this}fadeOut(e={}){return this.animations.push(()=>d(this.element,e)),this}slideUp(e={}){return this.animations.push(()=>p(this.element,e)),this}slideDown(e={}){return this.animations.push(()=>f(this.element,e)),this}slideToggle(e={}){return this.animations.push(()=>m(this.element,e)),this}transform(e,t={}){return this.animations.push(()=>y(this.element,e,t)),this}delay(e){return this.animations.push(()=>new Promise(t=>setTimeout(t,e))),this}then(e){return this.animations.push(()=>"function"==typeof e?Promise.resolve(e(this.element)):Promise.resolve()),this}async play(){try{for(const e of this.animations)await e();return this.element}catch(e){throw console.error("[DOM Helpers Animation] Chain execution failed:",e),e}}}function b(e){return!e||e._hasAnimationMethods||(Object.defineProperty(e,"_hasAnimationMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e.fadeIn=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>h(e,t).then(n))}):h(e,t)},e.fadeOut=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>d(e,t).then(n))}):d(e,t)},e.slideUp=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>p(e,t).then(n))}):p(e,t)},e.slideDown=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>f(e,t).then(n))}):f(e,t)},e.slideToggle=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>m(e,t).then(n))}):m(e,t)},e.transform=function(t,n={}){return o(n).queue&&!r.isEmpty(e)?new Promise(s=>{r.add(e,()=>y(e,t,n).then(s))}):y(e,t,n)},e.animate=function(){return new g(e)},e.stopAnimations=function(){return r.clear(e),s.transitions&&e.style.removeProperty(s.transitions.property),e}),e}function E(e){if(!e||e._hasAnimationMethods)return e;function t(t,n={}){const s=e._originalCollection||e._originalNodeList||e,r=Array.from(s).map((e,s)=>{if(e&&e.nodeType===Node.ELEMENT_NODE){const r={...n};return n.stagger&&s>0&&(r.delay=(r.delay||0)+n.stagger*s),e._hasAnimationMethods||b(e),t(e,r)}return Promise.resolve()});return Promise.all(r).then(()=>e)}return Object.defineProperty(e,"_hasAnimationMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e.fadeIn=function(e={}){return t(h,e)},e.fadeOut=function(e={}){return t(d,e)},e.slideUp=function(e={}){return t(p,e)},e.slideDown=function(e={}){return t(f,e)},e.slideToggle=function(e={}){return t(m,e)},e.transform=function(e,n={}){return t((t,n)=>y(t,e,n),n)},e.stopAnimations=function(){const t=e._originalCollection||e._originalNodeList||e;return Array.from(t).forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&(r.clear(e),s.transitions&&e.style.removeProperty(s.transitions.property))}),e},e}function v(e,t=!1){return function(t={}){if(!t||"object"!=typeof t)return console.warn("[DOM Helpers Animation] .update() called with invalid updates object"),this;const n={...t},s=[];if(void 0!==n.fadeIn){const e=!0===n.fadeIn?{}:n.fadeIn;s.push(this.fadeIn(e)),delete n.fadeIn}if(void 0!==n.fadeOut){const e=!0===n.fadeOut?{}:n.fadeOut;s.push(this.fadeOut(e)),delete n.fadeOut}if(void 0!==n.slideUp){const e=!0===n.slideUp?{}:n.slideUp;s.push(this.slideUp(e)),delete n.slideUp}if(void 0!==n.slideDown){const e=!0===n.slideDown?{}:n.slideDown;s.push(this.slideDown(e)),delete n.slideDown}if(void 0!==n.slideToggle){const e=!0===n.slideToggle?{}:n.slideToggle;s.push(this.slideToggle(e)),delete n.slideToggle}if(void 0!==n.transform){const{transformations:e,options:t={}}=n.transform;e&&s.push(this.transform(e,t)),delete n.transform}n.stopAnimations&&(this.stopAnimations(),delete n.stopAnimations);let r=this;return Object.keys(n).length>0&&e&&(r=e.call(this,n)),s.length>0?Promise.all(s).then(()=>r):r}}const w={fadeIn:h,fadeOut:d,slideUp:p,slideDown:f,slideToggle:m,transform:y,setDefaults:function(e){return Object.assign(t,e),this},getDefaults:function(){return{...t}},isSupported:function(e){switch(e){case"transitions":return!!s.transitions;case"transforms":return!!s.transforms;default:return!1}},clearQueue:function(e){return r.clear(e),this},enhance:function(e){return e&&e.nodeType===Node.ELEMENT_NODE?b(e):e&&(void 0!==e.length||e._originalCollection||e._originalNodeList)?E(e):e},chain:function(e){return new g(e)},easing:n,version:"1.0.0"};void 0!==e.Elements||void 0!==e.Collections||void 0!==e.Selector?(!function(){if(e.Elements&&e.Elements.helper){const t=e.Elements.helper._enhanceElementWithUpdate;t&&(e.Elements.helper._enhanceElementWithUpdate=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=v(t,!1)}return e});const n=e.Elements;if(n&&"object"==typeof n)try{if(e.Elements.helper&&e.Elements.helper._getElement){const t=e.Elements.helper._getElement;e.Elements.helper._getElement=function(e){const n=t.call(this,e);return n&&n.nodeType===Node.ELEMENT_NODE&&!n._hasAnimationMethods?b(n):n}}}catch(e){console.warn("[DOM Helpers Animation] Could not enhance Elements proxy:",e.message)}}if(e.Collections&&e.Collections.helper){const t=e.Collections.helper._enhanceCollectionWithUpdate;t&&(e.Collections.helper._enhanceCollectionWithUpdate=function(e){if((e=E(e=t.call(this,e))).update){const t=e.update;e.update=v(t,!0)}return e})}if(e.Selector&&e.Selector.helper){const t=e.Selector.helper._enhanceElementWithUpdate;t&&(e.Selector.helper._enhanceElementWithUpdate=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=v(t,!1)}return e});const n=e.Selector.helper._enhanceCollectionWithUpdate;n&&(e.Selector.helper._enhanceCollectionWithUpdate=function(e){if((e=E(e=n.call(this,e))).update){const t=e.update;e.update=v(t,!0)}return e})}if(e.Forms&&e.Forms.helper){const t=e.Forms.helper._enhanceForm;t&&(e.Forms.helper._enhanceForm=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=v(t,!1)}return e})}}(),console.log("[DOM Helpers Animation] Animation module integrated successfully")):console.log("[DOM Helpers Animation] Animation module loaded in standalone mode"),"undefined"!=typeof module&&module.exports?module.exports={Animation:w}:"function"==typeof define&&define.amd?define([],function(){return{Animation:w}}):e.Animation=w,e.DOMHelpers&&(e.DOMHelpers.Animation=w)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Form Module
 * Specialized form handling utilities that integrate with the main DOM Helpers library
 * 
 * Features:
 * - Forms object for accessing forms by ID
 * - Automatic form value extraction and setting
 * - Declarative form handling with .update() method
 * - Seamless integration with Elements, Collections, and Selector
 * - Enhanced form validation and submission handling
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";if(void 0===e.Elements&&"undefined"==typeof Elements)return void console.warn("[DOM Helpers Form] Main DOM Helpers library must be loaded before the Form module");function t(e){if(!e||e._hasFormMethods)return e;Object.defineProperty(e,"_hasFormMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(e,"values",{get:function(){return n(e)},set:function(t){s(e,t)},enumerable:!0,configurable:!0});const t=e.reset;return e.reset=function(n={}){return!1!==n.clearCustom&&c(e),t.call(e),e.dispatchEvent(new CustomEvent("formreset",{detail:{form:e},bubbles:!0})),e},e.validate=function(t={}){return a(e,t)},e.clearValidation=function(){return c(e),e},e.submitData=function(t={}){return async function(e,t={}){const{url:s=e.action||window.location.href,method:r=e.method||"POST",validate:o=!0,validationRules:i={},beforeSubmit:l=null,onSuccess:c=null,onError:u=null,transform:h=null}=t;try{if(o){const t=a(e,i);if(!t.isValid)return u&&u(new Error("Validation failed"),t.errors),{success:!1,errors:t.errors}}let t=n(e);if("function"==typeof h&&(t=h(t)),"function"==typeof l){if(!1===await l(t,e))return{success:!1,cancelled:!0}}const d={method:r.toUpperCase(),headers:{"Content-Type":"application/json"}};"GET"!==r.toUpperCase()&&(d.body=JSON.stringify(t));const p=await fetch(s,d),f=await p.json();if(p.ok)return c&&c(f,t),{success:!0,data:f};throw new Error(f.message||"Submission failed")}catch(e){return u&&u(e),{success:!1,error:e.message}}}(e,t)},e.getField=function(t){return r(e,t)},e.setField=function(t,n){return o(e,t,n),e},e.serialize=function(t="object"){return function(e,t="object"){const s=n(e);switch(t){case"json":return JSON.stringify(s);case"formdata":const e=new FormData;return Object.entries(s).forEach(([t,n])=>{Array.isArray(n)?n.forEach(n=>e.append(t,n)):e.append(t,n)}),e;case"urlencoded":return new URLSearchParams(s).toString();default:return s}}(e,t)},e}function n(e){const t={},n=new FormData(e);for(const[e,s]of n.entries())t[e]?Array.isArray(t[e])?t[e].push(s):t[e]=[t[e],s]:t[e]=s;return e.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(e=>{e.checked||!e.name||t.hasOwnProperty(e.name)||"checkbox"===e.type&&(t[e.name]=!1)}),t}function s(e,t){t&&"object"==typeof t?Object.entries(t).forEach(([t,n])=>{o(e,t,n)}):console.warn("[DOM Helpers Form] Invalid values object provided to setFormValues")}function r(e,t){let n=e.querySelector(`[name="${t}"]`);return n||(n=e.querySelector(`#${t}`)),n}function o(e,t,n){const s=e.querySelectorAll(`[name="${t}"]`);if(0===s.length){const s=e.querySelector(`#${t}`);return void(s&&i(s,n))}1===s.length?i(s[0],n):s.forEach(e=>{"radio"===e.type?e.checked=e.value===String(n):"checkbox"===e.type?Array.isArray(n)?e.checked=n.includes(e.value):e.checked=Boolean(n):i(e,n)})}function i(e,t){if(e){switch(e.type){case"checkbox":e.checked=Boolean(t);break;case"radio":e.checked=e.value===String(t);break;case"file":console.warn("[DOM Helpers Form] Cannot set file input values programmatically");break;case"select-multiple":Array.isArray(t)&&Array.from(e.options).forEach(e=>{e.selected=t.includes(e.value)});break;default:e.value=t}e.dispatchEvent(new Event("change",{bubbles:!0}))}}function a(e,t={}){const s={},o=n(e);c(e);if(!e.checkValidity()){e.querySelectorAll(":invalid").forEach(e=>{e.name&&(s[e.name]=e.validationMessage||"Invalid value",l(e,s[e.name]))})}return Object.entries(t).forEach(([t,n])=>{const i=o[t],a=r(e,t);if("function"==typeof n){const e=n(i,o,a);!0!==e&&void 0!==e&&(s[t]=e||"Invalid value",a&&l(a,s[t]))}else"object"==typeof n&&Object.entries(n).forEach(([e,n])=>{if(s[t])return;let r=!1,c="";switch(e){case"required":n&&(!i||"string"==typeof i&&""===i.trim())&&(r=!0,c="This field is required");break;case"minLength":i&&i.length<n&&(r=!0,c=`Minimum length is ${n} characters`);break;case"maxLength":i&&i.length>n&&(r=!0,c=`Maximum length is ${n} characters`);break;case"pattern":i&&!new RegExp(n).test(i)&&(r=!0,c="Invalid format");break;case"email":n&&i&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)&&(r=!0,c="Invalid email address");break;case"custom":if("function"==typeof n){const e=n(i,o,a);!0!==e&&void 0!==e&&(r=!0,c=e||"Invalid value")}}r&&(s[t]=c,a&&l(a,c))})}),{isValid:0===Object.keys(s).length,errors:s,values:o}}function l(e,t){e.classList.add("form-invalid"),e.setAttribute("aria-invalid","true");let n=e.parentNode.querySelector(".form-error-message");n||(n=document.createElement("div"),n.className="form-error-message",n.style.color="#dc3545",n.style.fontSize="0.875em",n.style.marginTop="0.25rem",e.parentNode.appendChild(n)),n.textContent=t}function c(e){e.querySelectorAll(".form-invalid").forEach(e=>{e.classList.remove("form-invalid"),e.removeAttribute("aria-invalid")});e.querySelectorAll(".form-error-message").forEach(e=>e.remove())}class u{constructor(e={}){this.cache=new Map,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??500,autoValidation:e.autoValidation??!1,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Forms=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getForm(t),has:(e,t)=>e._hasForm(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasForm(t))return{enumerable:!0,configurable:!0,value:e._getForm(t)}}})}_getForm(e){if("string"!=typeof e)return this._warn("Invalid form property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,t._isEnhancedForm?t:this._enhanceForm(t);this.cache.delete(e)}const t=document.getElementById(e);if(t&&"form"===t.tagName.toLowerCase()){const n=t._isEnhancedForm?t:this._enhanceForm(t);return this._addToCache(e,n),this.stats.misses++,n}return this.stats.misses++,this.options.enableLogging&&this._warn(`Form with id '${e}' not found`),null}_hasForm(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}const t=document.getElementById(e);return t&&"form"===t.tagName.toLowerCase()}_getKeys(){const e=document.querySelectorAll("form[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_enhanceForm(n){if(!n||n._isEnhancedForm)return n;try{e.Elements&&e.Elements.helper?n=e.Elements.helper._enhanceElementWithUpdate(n):"undefined"!=typeof Elements&&Elements.helper&&(n=Elements.helper._enhanceElementWithUpdate(n))}catch(e){console.warn("[DOM Helpers Form] Could not enhance with Elements helper:",e.message)}return(n=t(n)).update?n.update=function(e){const t=e.update;return function(n={}){if(!n||"object"!=typeof n)return console.warn("[DOM Helpers Form] .update() called with invalid updates object"),e;const r={...n};if(r.values&&(s(e,r.values),delete r.values),r.validate){const t=!0===r.validate?{}:r.validate;a(e,t),delete r.validate}if(r.reset){const t=!0===r.reset?{}:r.reset;e.reset(t),delete r.reset}if(r.submit){const t=!0===r.submit?{}:r.submit;e.submitData(t),delete r.submit}return Object.keys(r).length>0?t.call(e,r):e}}(n):n.update=function(e={}){if(!e||"object"!=typeof e)return console.warn("[DOM Helpers Form] .update() called with invalid updates object"),n;const t={...e};if(t.values&&(s(n,t.values),delete t.values),t.validate){const e=!0===t.validate?{}:t.validate;a(n,e),delete t.validate}if(t.reset){const e=!0===t.reset?{}:t.reset;n.reset(e),delete t.reset}if(t.submit){const e=!0===t.submit?{}:t.submit;n.submitData(e),delete t.submit}return t.addEventListener&&("function"==typeof handleEnhancedEventListener?handleEnhancedEventListener(n,t.addEventListener):"object"==typeof t.addEventListener&&Object.entries(t.addEventListener).forEach(([e,t])=>{"function"==typeof t&&n.addEventListener(e,t)}),delete t.addEventListener),Object.entries(t).forEach(([e,t])=>{try{e in n?n[e]=t:"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||n.setAttribute(e,t)}catch(t){console.warn(`[DOM Helpers Form] Could not set ${e}:`,t.message)}}),n},Object.defineProperty(n,"_isEnhancedForm",{value:!0,writable:!1,enumerable:!1,configurable:!1}),n}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size}_initMutationObserver(){this.observer=new MutationObserver(e=>{this._processMutations(e)}),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&"form"===e.tagName.toLowerCase()&&e.id&&t.add(e.id)}),e.removedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&"form"===e.tagName.toLowerCase()&&e.id&&n.add(e.id)}),"attributes"===e.type&&"id"===e.attributeName){const s=e.target;if("form"===s.tagName.toLowerCase()){const r=e.oldValue,o=s.id;r&&r!==o&&n.add(r),o&&o!==r&&t.add(o)}}}),t.forEach(e=>{const t=document.getElementById(e);t&&"form"===t.tagName.toLowerCase()&&this._addToCache(e,t)}),n.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;const e=[];for(const[t,n]of this.cache)n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)&&n.id===t&&"form"===n.tagName.toLowerCase()||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_log(e){this.options.enableLogging&&console.log(`[Forms] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Forms] ${e}`)}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Forms helper destroyed")}getAllForms(){const e=document.querySelectorAll("form[id]");return Array.from(e).map(e=>e._isEnhancedForm?e:this._enhanceForm(e))}validateAll(e={}){const t={};return this.getAllForms().forEach(n=>{n.id&&(t[n.id]=n.validate(e[n.id]||{}))}),t}resetAll(){this.getAllForms().forEach(e=>e.reset())}}const h=new u({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:500}),d=h.Forms;d.helper=h,d.stats=()=>h.getStats(),d.clear=()=>h.clearCache(),d.destroy=()=>h.destroy(),d.getAllForms=()=>h.getAllForms(),d.validateAll=e=>h.validateAll(e),d.resetAll=()=>h.resetAll(),d.configure=e=>(Object.assign(h.options,e),d),"undefined"!=typeof module&&module.exports?module.exports={Forms:d,ProductionFormsHelper:u}:"function"==typeof define&&define.amd?define([],function(){return{Forms:d,ProductionFormsHelper:u}}):(e.Forms=d,e.ProductionFormsHelper=u),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{h.destroy()}),e.DOMHelpers&&(e.DOMHelpers.Forms=d,e.DOMHelpers.ProductionFormsHelper=u),console.log("[DOM Helpers Form] Form module loaded successfully")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Storage Module
 * Web Storage API utilities that integrate with the main DOM Helpers library
 * 
 * Features:
 * - Storage object for localStorage and sessionStorage
 * - Automatic JSON serialization/deserialization
 * - Expiry system for time-based storage
 * - Namespace support for organized storage
 * - Forms integration for auto-save/restore
 * - Dual API: shorthand (set/get) and vanilla-like (setItem/getItem)
 * - Seamless integration with Elements, Collections, Selector, and Forms
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";function t(e){if(!e)return!0;try{const t=JSON.parse(e);return t.expires&&Date.now()>t.expires}catch(e){return!1}}void 0===e.Elements&&"undefined"==typeof Elements&&console.warn("[DOM Helpers Storage] Main DOM Helpers library should be loaded before the Storage module for full integration");class n{constructor(t="localStorage",n=""){this.storageType=t,this.namespace=n,this.storage=e[t],this.storage||(console.warn(`[DOM Helpers Storage] ${t} is not available`),this.storage={getItem:()=>null,setItem:()=>{},removeItem:()=>{},clear:()=>{},key:()=>null,length:0})}_getKey(e){return this.namespace?`${this.namespace}:${e}`:e}_stripNamespace(e){if(!this.namespace)return e;const t=`${this.namespace}:`;return e.startsWith(t)?e.slice(t.length):e}set(e,t,n={}){try{const s=this._getKey(e),r=function(e,t={}){const n={value:e,type:typeof e,timestamp:Date.now()};return t.expires&&("number"==typeof t.expires?n.expires=Date.now()+1e3*t.expires:t.expires instanceof Date&&(n.expires=t.expires.getTime())),JSON.stringify(n)}(t,n);return this.storage.setItem(s,r),!0}catch(t){return console.warn(`[DOM Helpers Storage] Failed to set ${e}:`,t.message),!1}}get(e,n=null){try{const s=this._getKey(e),r=this.storage.getItem(s);if(null===r)return n;if(t(r))return this.storage.removeItem(s),n;const o=function(e){if(!e)return null;try{const t=JSON.parse(e);return t.expires&&Date.now()>t.expires?null:t.value}catch(t){return e}}(r);return null!==o?o:n}catch(t){return console.warn(`[DOM Helpers Storage] Failed to get ${e}:`,t.message),n}}remove(e){try{const t=this._getKey(e);return this.storage.removeItem(t),!0}catch(t){return console.warn(`[DOM Helpers Storage] Failed to remove ${e}:`,t.message),!1}}has(e){try{const n=this._getKey(e),s=this.storage.getItem(n);return null!==s&&(!t(s)||(this.storage.removeItem(n),!1))}catch(e){return!1}}keys(){try{const e=[],n=this.namespace?`${this.namespace}:`:"";for(let s=0;s<this.storage.length;s++){const r=this.storage.key(s);if(r&&(!this.namespace||r.startsWith(n))){if(t(this.storage.getItem(r))){this.storage.removeItem(r);continue}e.push(this._stripNamespace(r))}}return e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get keys:",e.message),[]}}values(){try{const e=[];return this.keys().forEach(t=>{const n=this.get(t);null!==n&&e.push(n)}),e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get values:",e.message),[]}}entries(){try{const e=[];return this.keys().forEach(t=>{const n=this.get(t);null!==n&&e.push([t,n])}),e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get entries:",e.message),[]}}clear(){try{if(this.namespace){this.keys().forEach(e=>this.remove(e))}else this.storage.clear();return!0}catch(e){return console.warn("[DOM Helpers Storage] Failed to clear storage:",e.message),!1}}size(){return this.keys().length}namespace(e){const t=this.namespace?`${this.namespace}:${e}`:e;return new n(this.storageType,t)}setItem(e,t,n){return this.set(e,t,n)}getItem(e,t){return this.get(e,t)}removeItem(e){return this.remove(e)}setMultiple(e,t={}){const n={};return Object.entries(e).forEach(([e,s])=>{n[e]=this.set(e,s,t)}),n}getMultiple(e,t=null){const n={};return e.forEach(e=>{n[e]=this.get(e,t)}),n}removeMultiple(e){const t={};return e.forEach(e=>{t[e]=this.remove(e)}),t}increment(e,t=1){const n=this.get(e,0),s=("number"==typeof n?n:0)+t;return this.set(e,s),s}decrement(e,t=1){return this.increment(e,-t)}toggle(e){const t=!this.get(e,!1);return this.set(e,t),t}cleanup(){try{let e=0;const n=this.namespace?`${this.namespace}:`:"";for(let s=this.storage.length-1;s>=0;s--){const r=this.storage.key(s);!r||this.namespace&&!r.startsWith(n)||t(this.storage.getItem(r))&&(this.storage.removeItem(r),e++)}return e}catch(e){return console.warn("[DOM Helpers Storage] Failed to cleanup:",e.message),0}}stats(){try{const e=this.keys(),t=this.values(),n=JSON.stringify(t).length;return{keys:e.length,totalSize:n,averageSize:e.length>0?Math.round(n/e.length):0,namespace:this.namespace||"global",storageType:this.storageType}}catch(e){return{keys:0,totalSize:0,averageSize:0,namespace:this.namespace||"global",storageType:this.storageType}}}}function s(){if(void 0===e.Forms&&"undefined"==typeof Forms)return void console.log("[DOM Helpers Storage] Forms not available, skipping integration");const t=e.Forms||Forms;if(!t.helper||"function"!=typeof t.helper._getForm){if(console.warn("[DOM Helpers Storage] Forms helper not properly initialized, trying alternative approach"),t&&"object"==typeof t){try{console.log("[DOM Helpers Storage] Using direct form enhancement approach")}catch(e){console.warn("[DOM Helpers Storage] Could not wrap Forms proxy:",e.message)}}return}console.log("[DOM Helpers Storage] Adding Forms integration");const n=t.helper._getForm.bind(t.helper);t.helper._getForm=function(e){return r(n(e))}}function r(e){return!e||e._hasStorageIntegration||(e.autoSave=function(t,n={}){const{storage:s="localStorage",interval:r=1e3,events:o=["input","change"],namespace:i=""}=n,l=i?a.namespace(i):"sessionStorage"===s?a.session:a,c=()=>{const s=e.values;l.set(t,s,n)};return o.forEach(t=>{e.addEventListener(t,()=>{clearTimeout(e._autoSaveTimeout),e._autoSaveTimeout=setTimeout(c,r)})}),c(),e._autoSaveKey=t,e._autoSaveStorage=l,e},e.restore=function(t,n={}){const{storage:s="localStorage",namespace:r="",clearAfterRestore:o=!1}=n,i=r?a.namespace(r):"sessionStorage"===s?a.session:a,l=i.get(t);return l&&(e.values=l,o&&i.remove(t)),e},e.clearAutoSave=function(){return e._autoSaveTimeout&&clearTimeout(e._autoSaveTimeout),e._autoSaveKey&&e._autoSaveStorage&&e._autoSaveStorage.remove(e._autoSaveKey),e},Object.defineProperty(e,"_hasStorageIntegration",{value:!0,writable:!1,enumerable:!1,configurable:!1})),e}const o=new n("localStorage"),i=new n("sessionStorage"),a=o;function l(){document.querySelectorAll("form[id]").forEach(t=>{if(!t._hasStorageIntegration&&(console.log(`[DOM Helpers Storage] Enhancing DOM form ${t.id} directly`),r(t),void 0!==e.Forms||"undefined"!=typeof Forms)){const n=e.Forms||Forms;try{n&&n.helper&&n.helper.cache&&n.helper.cache.set(t.id,t)}catch(e){console.warn(`[DOM Helpers Storage] Could not update Forms cache for ${t.id}:`,e.message)}}})}a.session=i,a.local=o,a.namespace=e=>o.namespace(e),a.cleanup=()=>({local:o.cleanup(),session:i.cleanup()}),a.stats=()=>({local:o.stats(),session:i.stats()}),"undefined"!=typeof module&&module.exports?module.exports={Storage:a,StorageHelper:n}:"function"==typeof define&&define.amd?define([],function(){return{Storage:a,StorageHelper:n}}):(e.Storage=a,e.StorageHelper=n),"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){s(),setTimeout(l,100)}):setTimeout(function(){s(),l()},0)),e.DOMHelpers&&(e.DOMHelpers.Storage=a,e.DOMHelpers.StorageHelper=n),console.log("[DOM Helpers Storage] Storage module loaded successfully")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);