/**
 * DOM Helpers - Combined Bundle (Unminified)
 * High-performance vanilla JavaScript DOM utilities with intelligent caching
 * 
 * Includes:
 * - Update Utility (Universal .update() method)
 * - Elements Helper (ID-based DOM access)
 * - Collections Helper (Class/Tag/Name-based DOM access)
 * - Selector Helper (querySelector/querySelectorAll with caching)
 * 
 * @version 2.1.0
 * @license MIT
 */
!function(e){"use strict";"undefined"!=typeof process&&process.env&&"development"===process.env.NODE_ENV||"undefined"!=typeof location&&location.hostname;const t=!1,n=new WeakMap,s=new WeakMap;function r(e){return n.has(e)||n.set(e,{}),n.get(e)}function o(e,t,n){r(e)[t]=n}function i(e){return s.has(e)||s.set(e,new Map),s.get(e)}function a(e,t){if(e===t)return!0;if(null==e||null==t)return e===t;if(typeof e!=typeof t)return!1;if("object"==typeof e){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,n)=>a(e,t[n]));const n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every(n=>a(e[n],t[n]))}return!1}function l(e,t,n,s){const r=i(e);r.has(t)||r.set(t,new Map);const o=r.get(t),a=n;o.has(a)||(e.addEventListener(t,n,s),o.set(a,{handler:n,options:s}))}function c(e,t=!1){return function(n={}){return n&&"object"==typeof n?t?d(e,n):u(e,n):(console.warn("[DOM Helpers] .update() called with invalid updates object"),e)}}function u(e,t){if(!e||!e.nodeType)return console.warn("[DOM Helpers] .update() called on null or invalid element"),e;try{Object.entries(t).forEach(([t,n])=>{h(e,t,n)})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e}function d(e,t){if(!e)return console.warn("[DOM Helpers] .update() called on null collection"),e;let n=[];if(void 0!==e.length)n=Array.from(e);else if(e._originalCollection)n=Array.from(e._originalCollection);else{if(!e._originalNodeList)return console.warn("[DOM Helpers] .update() called on unrecognized collection type"),e;n=Array.from(e._originalNodeList)}if(0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{h(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e}function h(e,t,n){try{const s=r(e);if("textContent"===t||"innerText"===t)return void(e[t]!==n&&s[t]!==n&&(e[t]=n,o(e,t,n)));if("innerHTML"===t)return void(e.innerHTML!==n&&s.innerHTML!==n&&(e.innerHTML=n,o(e,"innerHTML",n)));if("style"===t&&"object"==typeof n&&null!==n)return void function(e,t){const n=r(e),s=n.style||{};Object.entries(t).forEach(([t,n])=>{null!=n&&e.style[t]!==n&&s[t]!==n&&(e.style[t]=n,s[t]=n)}),n.style=s}(e,n);if("classList"===t&&"object"==typeof n&&null!==n)return void m(e,n);if("setAttribute"===t){if(Array.isArray(n)&&n.length>=2){const[t,s]=n;e.getAttribute(t)!==s&&e.setAttribute(t,s)}else"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.getAttribute(t)!==n&&e.setAttribute(t,n)});return}if("removeAttribute"===t)return void(Array.isArray(n)?n.forEach(t=>{e.hasAttribute(t)&&e.removeAttribute(t)}):"string"==typeof n&&e.hasAttribute(n)&&e.removeAttribute(n));if("getAttribute"===t&&"string"==typeof n){const t=e.getAttribute(n);return void console.log(`[DOM Helpers] getAttribute('${n}'):`,t)}if("addEventListener"===t)return void function(e,t){if(Array.isArray(t)&&t.length>=2){const[n,s,r]=t,o=f(s);return void l(e,n,o,r)}if("object"==typeof t&&null!==t&&!Array.isArray(t))return void Object.entries(t).forEach(([t,n])=>{if("function"==typeof n){const s=f(n);l(e,t,s)}else if(Array.isArray(n)&&n.length>=1){const[s,r]=n;if("function"==typeof s){const n=f(s);l(e,t,n,r)}}});console.warn("[DOM Helpers] Invalid addEventListener value format")}(e,n);if("removeEventListener"===t&&Array.isArray(n)&&n.length>=2){const[t,s,r]=n;return void function(e,t,n,s){const r=i(e);if(r.has(t)){const o=r.get(t),i=n;o.has(i)&&(e.removeEventListener(t,n,s),o.delete(i),0===o.size&&r.delete(t))}}(e,t,s,r)}if("dataset"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{e.dataset[t]!==n&&(e.dataset[t]=n)});if("function"==typeof e[t])return void(Array.isArray(n)?e[t](...n):e[t](n));if(t in e)return void(a(e[t],n)||a(s[t],n)||(e[t]=n,o(e,t,n)));if("string"==typeof n||"number"==typeof n||"boolean"==typeof n){const s=e.getAttribute(t),r=String(n);return void(s!==r&&e.setAttribute(t,r))}console.warn(`[DOM Helpers] Unknown property or method: ${t}`)}catch(e){console.warn(`[DOM Helpers] Failed to apply update ${t}: ${e.message}`)}}function p(e,t){if(Array.isArray(t)&&t.length>=2){const[n,s,r]=t,o=f(s);return void e.addEventListener(n,o,r)}"object"!=typeof t||null===t||Array.isArray(t)?console.warn("[DOM Helpers] Invalid addEventListener value format"):Object.entries(t).forEach(([t,n])=>{if("function"==typeof n){const s=f(n);e.addEventListener(t,s)}else if(Array.isArray(n)&&n.length>=1){const[s,r]=n;if("function"==typeof s){const n=f(s);e.addEventListener(t,n,r)}}})}function f(e){return function(t){return t.target&&!t.target.update&&y(t.target),this&&this.nodeType===Node.ELEMENT_NODE&&!this.update&&y(this),e.call(this,t)}}function m(e,t){Object.entries(t).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1]);break;case"contains":Array.isArray(n)?n.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof n&&console.log(`[DOM Helpers] classList.contains('${n}'):`,e.classList.contains(n));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}function y(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:c(e,!1),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=c(e,!1),e._hasEnhancedUpdateMethod=!0}return e}function g(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:c(e,!0),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=c(e,!0),e._hasEnhancedUpdateMethod=!0}return e}function b(e){return e&&(void 0!==e.length||e._originalCollection||e._originalNodeList||e instanceof NodeList||e instanceof HTMLCollection)}const E={createEnhancedUpdateMethod:c,enhanceElementWithUpdate:y,enhanceCollectionWithUpdate:g,autoEnhanceWithUpdate:function(e){return e?b(e)?g(e):e.nodeType===Node.ELEMENT_NODE?y(e):e:e},isCollection:b,updateSingleElement:u,updateCollection:d,applyEnhancedUpdate:h,handleClassListUpdate:m,createUpdateExample:function(){return{textContent:"Enhanced Button",innerHTML:"<strong>Enhanced</strong> Button",id:"myEnhancedButton",className:"btn btn-primary",style:{color:"white",backgroundColor:"#007bff",padding:"10px 20px",border:"none",borderRadius:"5px"},classList:{add:["fancy","highlight"],remove:["old-class"],toggle:"active",replace:["btn-old","btn-new"]},setAttribute:["data-role","button"],removeAttribute:"disabled",dataset:{userId:"123",action:"submit"},addEventListener:["click",e=>{console.log("Button clicked!",e),e.target.classList.toggle("clicked")}],focus:[],scrollIntoView:[{behavior:"smooth"}]}}};let w;if("undefined"!=typeof module&&module.exports?module.exports=E:"function"==typeof define&&define.amd?define([],function(){return E}):e.EnhancedUpdateUtility=E,"undefined"!=typeof require)try{w=require("./update-utility.js")}catch(e){}else void 0!==e&&e.UpdateUtility&&(w=e.UpdateUtility);class v{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Elements=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getElement(t),has:(e,t)=>e._hasElement(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasElement(t))return{enumerable:!0,configurable:!0,value:e._getElement(t)}}})}_getElement(e){if("string"!=typeof e)return this._warn("Invalid element property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,this._enhanceElementWithUpdate(t);this.cache.delete(e)}const t=document.getElementById(e);return t?(this._addToCache(e,t),this.stats.misses++,this._enhanceElementWithUpdate(t)):(this.stats.misses++,this.options.enableLogging&&this._warn(`Element with id '${e}' not found`),null)}_hasElement(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}return!!document.getElementById(e)}_getKeys(){const e=document.querySelectorAll("[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{id:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&t.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&t.add(e.id)})}catch(e){}}}),e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&n.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&n.add(e.id)})}catch(e){}}}),"attributes"===e.type&&"id"===e.attributeName){const s=e.oldValue,r=e.target.id;s&&s!==r&&n.add(s),r&&r!==s&&t.add(r)}}),t.forEach(e=>{const t=document.getElementById(e);t&&this._addToCache(e,t)}),n.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)&&n.id===t||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Elements] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Elements] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(E&&E.enhanceElementWithUpdate)return E.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{if("style"!==t||"object"!=typeof n||null===n)if("classList"!==t||"object"!=typeof n||null===n)if("setAttribute"!==t)if("removeAttribute"!==t)if("dataset"!==t||"object"!=typeof n||null===n)if("addEventListener"!==t){if("removeEventListener"===t&&Array.isArray(n)&&n.length>=2){const[t,s,r]=n;return void e.removeEventListener(t,s,r)}"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n)}else p(e,n);else Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n});else Array.isArray(n)?n.forEach(t=>e.removeAttribute(t)):"string"==typeof n&&e.removeAttribute(n);else Array.isArray(n)&&n.length>=2?e.setAttribute(n[0],n[1]):"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.setAttribute(t,n)});else Object.entries(n).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}});else Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"classList"!==t||"object"!=typeof n||null===n?"setAttribute"!==t?"addEventListener"!==t?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):p(e,n):Array.isArray(n)&&n.length>=2?e.setAttribute(n[0],n[1]):"object"==typeof n&&null!==n&&Object.entries(n).forEach(([t,n])=>{e.setAttribute(t,n)}):Object.entries(n).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}}):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Elements helper destroyed")}isCached(e){return this.cache.has(e)}getCacheSnapshot(){return Array.from(this.cache.keys())}destructure(...e){const t={},n=[];return e.forEach(e=>{const s=this.Elements[e];s?t[e]=s:(n.push(e),t[e]=null)}),n.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${n.join(", ")}`),t}getRequired(...e){const t=this.destructure(...e),n=e.filter(e=>!t[e]);if(n.length>0)throw new Error(`Required elements not found: ${n.join(", ")}`);return t}async waitFor(...e){const t=Date.now();for(;Date.now()-t<5e3;){const t=this.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)}get(e,t=null){return this.Elements[e]||t}exists(e){return!!this.Elements[e]}getMultiple(...e){return this.destructure(...e)}setProperty(e,t,n){const s=this.Elements[e];return!(!s||!(t in s))&&(s[t]=n,!0)}getProperty(e,t,n=void 0){const s=this.Elements[e];return s&&t in s?s[t]:n}setAttribute(e,t,n){const s=this.Elements[e];return!!s&&(s.setAttribute(t,n),!0)}getAttribute(e,t,n=null){const s=this.Elements[e];return s&&s.getAttribute(t)||n}}const _=new v({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),C=_.Elements;C.helper=_,C.stats=()=>_.getStats(),C.clear=()=>_.clearCache(),C.destroy=()=>_.destroy(),C.destructure=(...e)=>_.destructure(...e),C.getRequired=(...e)=>_.getRequired(...e),C.waitFor=(...e)=>_.waitFor(...e),C.isCached=e=>_.isCached(e),C.get=(e,t)=>_.get(e,t),C.exists=e=>_.exists(e),C.getMultiple=(...e)=>_.getMultiple(...e),C.setProperty=(e,t,n)=>_.setProperty(e,t,n),C.getProperty=(e,t,n)=>_.getProperty(e,t,n),C.setAttribute=(e,t,n)=>_.setAttribute(e,t,n),C.getAttribute=(e,t,n)=>_.getAttribute(e,t,n),C.configure=e=>(Object.assign(_.options,e),C),"undefined"!=typeof module&&module.exports?module.exports={Elements:C,ProductionElementsHelper:v}:"function"==typeof define&&define.amd?define([],function(){return{Elements:C,ProductionElementsHelper:v}}):(e.Elements=C,e.ProductionElementsHelper=v),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{_.destroy()});class A{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_initProxies(){this.ClassName=this._createCollectionProxy("className"),this.TagName=this._createCollectionProxy("tagName"),this.Name=this._createCollectionProxy("name")}_createCollectionProxy(e){return new Proxy(t=>{const n=this._getCollection(e,t);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(n):n},{get:(t,n)=>{if("symbol"==typeof n||"constructor"===n||"prototype"===n||"apply"===n||"call"===n||"bind"===n||"function"==typeof t[n])return t[n];const s=this._getCollection(e,n);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(s):s},apply:(e,t,n)=>n.length>0?e(n[0]):this._createEmptyCollection()})}_createEnhancedCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set element property ${t}: ${e.message}`),!1}}}):e}_createCacheKey(e,t){return`${e}:${t}`}_getCollection(e,t){if("string"!=typeof t)return this._warn(`Invalid ${e} property type: ${typeof t}`),this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const e=this.cache.get(n);if(this._isValidCollection(e))return this.stats.hits++,e;this.cache.delete(n)}let s;try{switch(e){case"className":s=document.getElementsByClassName(t);break;case"tagName":s=document.getElementsByTagName(t);break;case"name":s=document.getElementsByName(t);break;default:return this._warn(`Unknown collection type: ${e}`),this._createEmptyCollection()}}catch(n){return this._warn(`Error getting ${e} collection for "${t}": ${n.message}`),this._createEmptyCollection()}const r=this._enhanceCollection(s,e,t);return this._addToCache(n,r),this.stats.misses++,r}_isValidCollection(e){if(!e||!e._originalCollection)return!1;const t=e._originalCollection;if(0===t.length)return!0;const n=t[0];return n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)}_enhanceCollection(e,t,n){const s={_originalCollection:e,_type:t,_value:n,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),namedItem:t=>e.namedItem?e.namedItem(t):null,toArray:()=>Array.from(e),forEach(t,n){Array.from(e).forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))}};for(let t=0;t<e.length;t++)Object.defineProperty(s,t,{get:()=>e[t],enumerable:!0});return s[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(s)}_createEmptyCollection(){return this._enhanceCollection({length:0,item:()=>null,namedItem:()=>null},"empty","")}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set,s=new Set;e.forEach(e=>{if([...e.addedNodes,...e.removedNodes].forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase());try{(e.querySelectorAll?e.querySelectorAll("*"):[]).forEach(e=>{e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase())})}catch(e){}}}),"attributes"===e.type){const s=e.target;if("class"===e.attributeName){[...e.oldValue?e.oldValue.split(/\s+/):[],...s.className?s.className.split(/\s+/):[]].forEach(e=>{e&&t.add(e)})}"name"===e.attributeName&&(e.oldValue&&n.add(e.oldValue),s.name&&n.add(s.name))}});const r=[];for(const e of this.cache.keys()){const[o,i]=e.split(":",2);("className"===o&&t.has(i)||"name"===o&&n.has(i)||"tagName"===o&&s.has(i))&&r.push(e)}r.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,r.length>0&&this.options.enableLogging&&this._log(`Invalidated ${r.length} cache entries due to DOM changes`)}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)this._isValidCollection(n)||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Collections] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Collections] ${e}`)}_applyEnhancedUpdateToElement(e,t,n){h(e,t,n)}_handleClassListUpdate(e,t){Object.entries(t).forEach(([t,n])=>{try{switch(t){case"add":Array.isArray(n)?e.classList.add(...n):"string"==typeof n&&e.classList.add(n);break;case"remove":Array.isArray(n)?e.classList.remove(...n):"string"==typeof n&&e.classList.remove(n);break;case"toggle":Array.isArray(n)?n.forEach(t=>e.classList.toggle(t)):"string"==typeof n&&e.classList.toggle(n);break;case"replace":Array.isArray(n)&&2===n.length&&e.classList.replace(n[0],n[1]);break;case"contains":Array.isArray(n)?n.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof n&&console.log(`[DOM Helpers] classList.contains('${n}'):`,e.classList.contains(n));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(E&&E.enhanceCollectionWithUpdate)return E.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{this._applyEnhancedUpdateToElement(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{this._applyEnhancedUpdateToElement(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasEnhancedUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Collections helper destroyed")}isCached(e,t){return this.cache.has(this._createCacheKey(e,t))}getCacheSnapshot(){return Array.from(this.cache.keys())}getMultiple(e){const t={};return e.forEach(({type:e,value:n,as:s})=>{const r=s||`${e}_${n}`;switch(e){case"className":t[r]=this.ClassName[n];break;case"tagName":t[r]=this.TagName[n];break;case"name":t[r]=this.Name[n]}}),t}async waitForElements(e,t,n=1,s=5e3){const r=Date.now();for(;Date.now()-r<s;){let s;switch(e){case"className":s=this.ClassName[t];break;case"tagName":s=this.TagName[t];break;case"name":s=this.Name[t];break;default:throw new Error(`Unknown collection type: ${e}`)}if(s&&s.length>=n)return s;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for ${e}="${t}" (min: ${n})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this}}const O=new A({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableEnhancedSyntax:!0}),S={ClassName:O.ClassName,TagName:O.TagName,Name:O.Name,helper:O,stats:()=>O.getStats(),clear:()=>O.clearCache(),destroy:()=>O.destroy(),isCached:(e,t)=>O.isCached(e,t),getMultiple:e=>O.getMultiple(e),waitFor:(e,t,n,s)=>O.waitForElements(e,t,n,s),enableEnhancedSyntax:()=>O.enableEnhancedSyntax(),disableEnhancedSyntax:()=>O.disableEnhancedSyntax(),configure:e=>(Object.assign(O.options,e),S)};"undefined"!=typeof module&&module.exports?module.exports={Collections:S,ProductionCollectionHelper:A}:"function"==typeof define&&define.amd?define([],function(){return{Collections:S,ProductionCollectionHelper:A}}):(e.Collections=S,e.ProductionCollectionHelper=A),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{O.destroy()});class D{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableSmartCaching:e.enableSmartCaching??!0,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now(),selectorTypes:new Map},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this.selectorPatterns=this._buildSelectorPatterns(),this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_buildSelectorPatterns(){return{id:/^#([a-zA-Z][\w-]*)$/,class:/^\.([a-zA-Z][\w-]*)$/,tag:/^([a-zA-Z][a-zA-Z0-9]*)$/,attribute:/^\[([^\]]+)\]$/,descendant:/^(\w+)\s+(\w+)$/,child:/^(\w+)\s*>\s*(\w+)$/,pseudo:/^(\w+):([a-zA-Z-]+)$/}}_initProxies(){this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this.options.enableEnhancedSyntax&&this._initEnhancedSyntax(),this.Scoped={within:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return null;const s=`scoped:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"single",s)},withinAll:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return this._createEmptyCollection();const s=`scopedAll:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"multiple",s)}}}_initEnhancedSyntax(){const e=this.query;this.query=new Proxy(e,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("single",n);return s?this._createElementProxy(s):s},apply:(e,t,n)=>n.length>0?this._getQuery("single",n[0]):null});const t=this.queryAll;this.queryAll=new Proxy(t,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("multiple",n);return this._createCollectionProxy(s)},apply:(e,t,n)=>n.length>0?this._getQuery("multiple",n[0]):this._createEmptyCollection()})}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set property ${t}: ${e.message}`),!1}}}):e}_createCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createQueryFunction(e){const t=t=>this._getQuery(e,t);return t._queryType=e,t._helper=this,t}_normalizeSelector(e){const t=e.toString(),n=e=>`#${this._camelToKebab(e)}`,s=e=>`.${this._camelToKebab(e)}`;return t.startsWith("id")&&t.length>2?n(t.slice(2)):t.startsWith("class")&&t.length>5?s(t.slice(5)):/^[a-z][a-zA-Z]*$/.test(t)&&/[A-Z]/.test(t)?s(t):/^[a-z]+$/.test(t)&&t.length<10?t:t.match(/^[a-zA-Z][\w-]*$/)?`#${t}`:t}_camelToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}_createCacheKey(e,t){return`${e}:${t}`}_getQuery(e,t){if("string"!=typeof t)return this._warn("Invalid selector type: "+typeof t),"single"===e?null:this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const s=this.cache.get(n);if(this._isValidQuery(s,e))return this.stats.hits++,this._trackSelectorType(t),s;this.cache.delete(n)}let s;try{if("single"===e){const e=document.querySelector(t);s=this._enhanceElementWithUpdate(e)}else{const e=document.querySelectorAll(t);s=this._enhanceNodeList(e,t)}}catch(n){return this._warn(`Invalid selector "${t}": ${n.message}`),"single"===e?null:this._createEmptyCollection()}return this._addToCache(n,s),this.stats.misses++,this._trackSelectorType(t),s}_getScopedQuery(e,t,n,s){if(this.cache.has(s)){const e=this.cache.get(s);if(this._isValidQuery(e,n))return this.stats.hits++,e;this.cache.delete(s)}let r;try{if("single"===n)r=e.querySelector(t);else{const n=e.querySelectorAll(t);r=this._enhanceNodeList(n,t)}}catch(e){return this._warn(`Invalid scoped selector "${t}": ${e.message}`),"single"===n?null:this._createEmptyCollection()}return this._addToCache(s,r),this.stats.misses++,r}_isValidQuery(e,t){if("single"===t)return e&&e.nodeType===Node.ELEMENT_NODE&&document.contains(e);{if(!e||!e._originalNodeList)return!1;const t=e._originalNodeList;if(0===t.length)return!0;const n=t[0];return n&&document.contains(n)}}_enhanceNodeList(e,t){const n={_originalNodeList:e,_selector:t,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),entries:()=>e.entries(),keys:()=>e.keys(),values:()=>e.values(),toArray:()=>Array.from(e),forEach(t,n){e.forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))},within(e){const t=[];return this.forEach(n=>{const s=n.querySelectorAll(e);t.push(...Array.from(s))}),this._helper._enhanceNodeList(t,`${this._selector} ${e}`)}};for(let t=0;t<e.length;t++)Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0});return n[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(n)}_createEmptyCollection(){const e=document.querySelectorAll("nonexistent-element-that-never-exists");return this._enhanceNodeList(e,"empty")}_trackSelectorType(e){const t=this._classifySelector(e),n=this.stats.selectorTypes.get(t)||0;this.stats.selectorTypes.set(t,n+1)}_classifySelector(e){return this.selectorPatterns.id.test(e)?"id":this.selectorPatterns.class.test(e)?"class":this.selectorPatterns.tag.test(e)?"tag":this.selectorPatterns.attribute.test(e)?"attribute":this.selectorPatterns.descendant.test(e)?"descendant":this.selectorPatterns.child.test(e)?"child":this.selectorPatterns.pseudo.test(e)?"pseudo":"complex"}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,t&&t.nodeType===Node.ELEMENT_NODE&&this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){if(!this.options.enableSmartCaching)return;const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set;if(e.forEach(e=>{if("childList"===e.type&&t.add("*"),"attributes"===e.type){const n=e.target,s=e.attributeName;if("id"===s){const s=e.oldValue;s&&t.add(`#${s}`),n.id&&t.add(`#${n.id}`)}if("class"===s){[...e.oldValue?e.oldValue.split(/\s+/):[],...n.className?n.className.split(/\s+/):[]].forEach(e=>{e&&t.add(`.${e}`)})}t.add(`[${s}]`)}}),t.has("*"))this.cache.clear();else{const e=[];for(const n of this.cache.keys()){const[s,r]=n.split(":",2);for(const s of t)if(r.includes(s)){e.push(n);break}}e.forEach(e=>this.cache.delete(e))}this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache){const[s]=t.split(":",1);this._isValidQuery(n,"single"===s?"single":"multiple")||e.push(t)}e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Selector] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Selector] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(E&&E.enhanceElementWithUpdate)return E.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(e._originalCollection&&Array.from(e._originalCollection).forEach(e=>{e&&(e.nodeType,Node.ELEMENT_NODE)}),E&&E.enhanceCollectionWithUpdate)return E.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup,selectorBreakdown:Object.fromEntries(this.stats.selectorTypes)}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this.stats.selectorTypes.clear(),this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Selector helper destroyed")}async waitForSelector(e,t=5e3){const n=Date.now();for(;Date.now()-n<t;){const t=this.query(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e}`)}async waitForSelectorAll(e,t=1,n=5e3){const s=Date.now();for(;Date.now()-s<n;){const n=this.queryAll(e);if(n&&n.length>=t)return n;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e} (min: ${t})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this._initEnhancedSyntax(),this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this}}const M=new D({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableSmartCaching:!0,enableEnhancedSyntax:!0}),L={query:M.query,queryAll:M.queryAll,Scoped:M.Scoped,helper:M,stats:()=>M.getStats(),clear:()=>M.clearCache(),destroy:()=>M.destroy(),waitFor:(e,t)=>M.waitForSelector(e,t),waitForAll:(e,t,n)=>M.waitForSelectorAll(e,t,n),enableEnhancedSyntax:()=>M.enableEnhancedSyntax(),disableEnhancedSyntax:()=>M.disableEnhancedSyntax(),configure:e=>(Object.assign(M.options,e),L)};"undefined"!=typeof module&&module.exports?module.exports={Selector:L,ProductionSelectorHelper:D}:"function"==typeof define&&define.amd?define([],function(){return{Selector:L,ProductionSelectorHelper:D}}):(e.Selector=L,e.ProductionSelectorHelper=D),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{M.destroy()});const T={Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper,version:"2.0.0",isReady(){return!!(this.Elements&&this.Collections&&this.Selector)},getStats(){const e={};return this.Elements&&"function"==typeof this.Elements.stats&&(e.elements=this.Elements.stats()),this.Collections&&"function"==typeof this.Collections.stats&&(e.collections=this.Collections.stats()),this.Selector&&"function"==typeof this.Selector.stats&&(e.selector=this.Selector.stats()),e},clearAll(){this.Elements&&"function"==typeof this.Elements.clear&&this.Elements.clear(),this.Collections&&"function"==typeof this.Collections.clear&&this.Collections.clear(),this.Selector&&"function"==typeof this.Selector.clear&&this.Selector.clear()},destroyAll(){this.Elements&&"function"==typeof this.Elements.destroy&&this.Elements.destroy(),this.Collections&&"function"==typeof this.Collections.destroy&&this.Collections.destroy(),this.Selector&&"function"==typeof this.Selector.destroy&&this.Selector.destroy()},configure(e={}){return this.Elements&&"function"==typeof this.Elements.configure&&this.Elements.configure(e.elements||e),this.Collections&&"function"==typeof this.Collections.configure&&this.Collections.configure(e.collections||e),this.Selector&&"function"==typeof this.Selector.configure&&this.Selector.configure(e.selector||e),this}};"undefined"!=typeof module&&module.exports?module.exports={DOMHelpers:T,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}:"function"==typeof define&&define.amd?define([],function(){return{DOMHelpers:T,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}}):e.DOMHelpers=T,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{T.destroyAll()}),function(){const n=document.createElement;function s(e,t){const s=n.call(document,e,t);return y(s)}t&&(document.createElement=s),void 0!==e.DOMHelpers&&(e.DOMHelpers.enableCreateElementEnhancement=function(){return document.createElement=s,this},e.DOMHelpers.disableCreateElementEnhancement=function(){return document.createElement=n,this}),document.createElement.restore=function(){document.createElement=n}}()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Storage Module
 * Web Storage API utilities that integrate with the main DOM Helpers library
 * 
 * Features:
 * - Storage object for localStorage and sessionStorage
 * - Automatic JSON serialization/deserialization
 * - Expiry system for time-based storage
 * - Namespace support for organized storage
 * - Forms integration for auto-save/restore
 * - Dual API: shorthand (set/get) and vanilla-like (setItem/getItem)
 * - Seamless integration with Elements, Collections, Selector, and Forms
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";function t(e){if(!e)return!0;try{const t=JSON.parse(e);return t.expires&&Date.now()>t.expires}catch(e){return!1}}void 0===e.Elements&&"undefined"==typeof Elements&&console.warn("[DOM Helpers Storage] Main DOM Helpers library should be loaded before the Storage module for full integration");class n{constructor(t="localStorage",n=""){this.storageType=t,this.namespace=n,this.storage=e[t],this.storage||(console.warn(`[DOM Helpers Storage] ${t} is not available`),this.storage={getItem:()=>null,setItem:()=>{},removeItem:()=>{},clear:()=>{},key:()=>null,length:0})}_getKey(e){return this.namespace?`${this.namespace}:${e}`:e}_stripNamespace(e){if(!this.namespace)return e;const t=`${this.namespace}:`;return e.startsWith(t)?e.slice(t.length):e}set(e,t,n={}){try{const s=this._getKey(e),r=function(e,t={}){const n={value:e,type:typeof e,timestamp:Date.now()};return t.expires&&("number"==typeof t.expires?n.expires=Date.now()+1e3*t.expires:t.expires instanceof Date&&(n.expires=t.expires.getTime())),JSON.stringify(n)}(t,n);return this.storage.setItem(s,r),!0}catch(t){return console.warn(`[DOM Helpers Storage] Failed to set ${e}:`,t.message),!1}}get(e,n=null){try{const s=this._getKey(e),r=this.storage.getItem(s);if(null===r)return n;if(t(r))return this.storage.removeItem(s),n;const o=function(e){if(!e)return null;try{const t=JSON.parse(e);return t.expires&&Date.now()>t.expires?null:t.value}catch(t){return e}}(r);return null!==o?o:n}catch(t){return console.warn(`[DOM Helpers Storage] Failed to get ${e}:`,t.message),n}}remove(e){try{const t=this._getKey(e);return this.storage.removeItem(t),!0}catch(t){return console.warn(`[DOM Helpers Storage] Failed to remove ${e}:`,t.message),!1}}has(e){try{const n=this._getKey(e),s=this.storage.getItem(n);return null!==s&&(!t(s)||(this.storage.removeItem(n),!1))}catch(e){return!1}}keys(){try{const e=[],n=this.namespace?`${this.namespace}:`:"";for(let s=0;s<this.storage.length;s++){const r=this.storage.key(s);if(r&&(!this.namespace||r.startsWith(n))){if(t(this.storage.getItem(r))){this.storage.removeItem(r);continue}e.push(this._stripNamespace(r))}}return e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get keys:",e.message),[]}}values(){try{const e=[];return this.keys().forEach(t=>{const n=this.get(t);null!==n&&e.push(n)}),e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get values:",e.message),[]}}entries(){try{const e=[];return this.keys().forEach(t=>{const n=this.get(t);null!==n&&e.push([t,n])}),e}catch(e){return console.warn("[DOM Helpers Storage] Failed to get entries:",e.message),[]}}clear(){try{if(this.namespace){this.keys().forEach(e=>this.remove(e))}else this.storage.clear();return!0}catch(e){return console.warn("[DOM Helpers Storage] Failed to clear storage:",e.message),!1}}size(){return this.keys().length}namespace(e){const t=this.namespace?`${this.namespace}:${e}`:e;return new n(this.storageType,t)}setItem(e,t,n){return this.set(e,t,n)}getItem(e,t){return this.get(e,t)}removeItem(e){return this.remove(e)}setMultiple(e,t={}){const n={};return Object.entries(e).forEach(([e,s])=>{n[e]=this.set(e,s,t)}),n}getMultiple(e,t=null){const n={};return e.forEach(e=>{n[e]=this.get(e,t)}),n}removeMultiple(e){const t={};return e.forEach(e=>{t[e]=this.remove(e)}),t}increment(e,t=1){const n=this.get(e,0),s=("number"==typeof n?n:0)+t;return this.set(e,s),s}decrement(e,t=1){return this.increment(e,-t)}toggle(e){const t=!this.get(e,!1);return this.set(e,t),t}cleanup(){try{let e=0;const n=this.namespace?`${this.namespace}:`:"";for(let s=this.storage.length-1;s>=0;s--){const r=this.storage.key(s);!r||this.namespace&&!r.startsWith(n)||t(this.storage.getItem(r))&&(this.storage.removeItem(r),e++)}return e}catch(e){return console.warn("[DOM Helpers Storage] Failed to cleanup:",e.message),0}}stats(){try{const e=this.keys(),t=this.values(),n=JSON.stringify(t).length;return{keys:e.length,totalSize:n,averageSize:e.length>0?Math.round(n/e.length):0,namespace:this.namespace||"global",storageType:this.storageType}}catch(e){return{keys:0,totalSize:0,averageSize:0,namespace:this.namespace||"global",storageType:this.storageType}}}}function s(){if(void 0===e.Forms&&"undefined"==typeof Forms)return void console.log("[DOM Helpers Storage] Forms not available, skipping integration");const t=e.Forms||Forms;if(!t.helper||"function"!=typeof t.helper._getForm){if(console.warn("[DOM Helpers Storage] Forms helper not properly initialized, trying alternative approach"),t&&"object"==typeof t){try{console.log("[DOM Helpers Storage] Using direct form enhancement approach")}catch(e){console.warn("[DOM Helpers Storage] Could not wrap Forms proxy:",e.message)}}return}console.log("[DOM Helpers Storage] Adding Forms integration");const n=t.helper._getForm.bind(t.helper);t.helper._getForm=function(e){return r(n(e))}}function r(e){return!e||e._hasStorageIntegration||(e.autoSave=function(t,n={}){const{storage:s="localStorage",interval:r=1e3,events:o=["input","change"],namespace:i=""}=n,l=i?a.namespace(i):"sessionStorage"===s?a.session:a,c=()=>{const s=e.values;l.set(t,s,n)};return o.forEach(t=>{e.addEventListener(t,()=>{clearTimeout(e._autoSaveTimeout),e._autoSaveTimeout=setTimeout(c,r)})}),c(),e._autoSaveKey=t,e._autoSaveStorage=l,e},e.restore=function(t,n={}){const{storage:s="localStorage",namespace:r="",clearAfterRestore:o=!1}=n,i=r?a.namespace(r):"sessionStorage"===s?a.session:a,l=i.get(t);return l&&(e.values=l,o&&i.remove(t)),e},e.clearAutoSave=function(){return e._autoSaveTimeout&&clearTimeout(e._autoSaveTimeout),e._autoSaveKey&&e._autoSaveStorage&&e._autoSaveStorage.remove(e._autoSaveKey),e},Object.defineProperty(e,"_hasStorageIntegration",{value:!0,writable:!1,enumerable:!1,configurable:!1})),e}const o=new n("localStorage"),i=new n("sessionStorage"),a=o;function l(){document.querySelectorAll("form[id]").forEach(t=>{if(!t._hasStorageIntegration&&(console.log(`[DOM Helpers Storage] Enhancing DOM form ${t.id} directly`),r(t),void 0!==e.Forms||"undefined"!=typeof Forms)){const n=e.Forms||Forms;try{n&&n.helper&&n.helper.cache&&n.helper.cache.set(t.id,t)}catch(e){console.warn(`[DOM Helpers Storage] Could not update Forms cache for ${t.id}:`,e.message)}}})}a.session=i,a.local=o,a.namespace=e=>o.namespace(e),a.cleanup=()=>({local:o.cleanup(),session:i.cleanup()}),a.stats=()=>({local:o.stats(),session:i.stats()}),"undefined"!=typeof module&&module.exports?module.exports={Storage:a,StorageHelper:n}:"function"==typeof define&&define.amd?define([],function(){return{Storage:a,StorageHelper:n}}):(e.Storage=a,e.StorageHelper=n),"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){s(),setTimeout(l,100)}):setTimeout(function(){s(),l()},0)),e.DOMHelpers&&(e.DOMHelpers.Storage=a,e.DOMHelpers.StorageHelper=n),console.log("[DOM Helpers Storage] Storage module loaded successfully")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Form Module
 * Specialized form handling utilities that integrate with the main DOM Helpers library
 * 
 * Features:
 * - Forms object for accessing forms by ID
 * - Automatic form value extraction and setting
 * - Declarative form handling with .update() method
 * - Seamless integration with Elements, Collections, and Selector
 * - Enhanced form validation and submission handling
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";if(void 0===e.Elements&&"undefined"==typeof Elements)return void console.warn("[DOM Helpers Form] Main DOM Helpers library must be loaded before the Form module");function t(e){if(!e||e._hasFormMethods)return e;Object.defineProperty(e,"_hasFormMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(e,"values",{get:function(){return n(e)},set:function(t){s(e,t)},enumerable:!0,configurable:!0});const t=e.reset;return e.reset=function(n={}){return!1!==n.clearCustom&&c(e),t.call(e),e.dispatchEvent(new CustomEvent("formreset",{detail:{form:e},bubbles:!0})),e},e.validate=function(t={}){return a(e,t)},e.clearValidation=function(){return c(e),e},e.submitData=function(t={}){return async function(e,t={}){const{url:s=e.action||window.location.href,method:r=e.method||"POST",validate:o=!0,validationRules:i={},beforeSubmit:l=null,onSuccess:c=null,onError:u=null,transform:d=null}=t;try{if(o){const t=a(e,i);if(!t.isValid)return u&&u(new Error("Validation failed"),t.errors),{success:!1,errors:t.errors}}let t=n(e);if("function"==typeof d&&(t=d(t)),"function"==typeof l){if(!1===await l(t,e))return{success:!1,cancelled:!0}}const h={method:r.toUpperCase(),headers:{"Content-Type":"application/json"}};"GET"!==r.toUpperCase()&&(h.body=JSON.stringify(t));const p=await fetch(s,h),f=await p.json();if(p.ok)return c&&c(f,t),{success:!0,data:f};throw new Error(f.message||"Submission failed")}catch(e){return u&&u(e),{success:!1,error:e.message}}}(e,t)},e.getField=function(t){return r(e,t)},e.setField=function(t,n){return o(e,t,n),e},e.serialize=function(t="object"){return function(e,t="object"){const s=n(e);switch(t){case"json":return JSON.stringify(s);case"formdata":const e=new FormData;return Object.entries(s).forEach(([t,n])=>{Array.isArray(n)?n.forEach(n=>e.append(t,n)):e.append(t,n)}),e;case"urlencoded":return new URLSearchParams(s).toString();default:return s}}(e,t)},e}function n(e){const t={},n=new FormData(e);for(const[e,s]of n.entries())t[e]?Array.isArray(t[e])?t[e].push(s):t[e]=[t[e],s]:t[e]=s;return e.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(e=>{e.checked||!e.name||t.hasOwnProperty(e.name)||"checkbox"===e.type&&(t[e.name]=!1)}),t}function s(e,t){t&&"object"==typeof t?Object.entries(t).forEach(([t,n])=>{o(e,t,n)}):console.warn("[DOM Helpers Form] Invalid values object provided to setFormValues")}function r(e,t){let n=e.querySelector(`[name="${t}"]`);return n||(n=e.querySelector(`#${t}`)),n}function o(e,t,n){const s=e.querySelectorAll(`[name="${t}"]`);if(0===s.length){const s=e.querySelector(`#${t}`);return void(s&&i(s,n))}1===s.length?i(s[0],n):s.forEach(e=>{"radio"===e.type?e.checked=e.value===String(n):"checkbox"===e.type?Array.isArray(n)?e.checked=n.includes(e.value):e.checked=Boolean(n):i(e,n)})}function i(e,t){if(e){switch(e.type){case"checkbox":e.checked=Boolean(t);break;case"radio":e.checked=e.value===String(t);break;case"file":console.warn("[DOM Helpers Form] Cannot set file input values programmatically");break;case"select-multiple":Array.isArray(t)&&Array.from(e.options).forEach(e=>{e.selected=t.includes(e.value)});break;default:e.value=t}e.dispatchEvent(new Event("change",{bubbles:!0}))}}function a(e,t={}){const s={},o=n(e);c(e);if(!e.checkValidity()){e.querySelectorAll(":invalid").forEach(e=>{e.name&&(s[e.name]=e.validationMessage||"Invalid value",l(e,s[e.name]))})}return Object.entries(t).forEach(([t,n])=>{const i=o[t],a=r(e,t);if("function"==typeof n){const e=n(i,o,a);!0!==e&&void 0!==e&&(s[t]=e||"Invalid value",a&&l(a,s[t]))}else"object"==typeof n&&Object.entries(n).forEach(([e,n])=>{if(s[t])return;let r=!1,c="";switch(e){case"required":n&&(!i||"string"==typeof i&&""===i.trim())&&(r=!0,c="This field is required");break;case"minLength":i&&i.length<n&&(r=!0,c=`Minimum length is ${n} characters`);break;case"maxLength":i&&i.length>n&&(r=!0,c=`Maximum length is ${n} characters`);break;case"pattern":i&&!new RegExp(n).test(i)&&(r=!0,c="Invalid format");break;case"email":n&&i&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)&&(r=!0,c="Invalid email address");break;case"custom":if("function"==typeof n){const e=n(i,o,a);!0!==e&&void 0!==e&&(r=!0,c=e||"Invalid value")}}r&&(s[t]=c,a&&l(a,c))})}),{isValid:0===Object.keys(s).length,errors:s,values:o}}function l(e,t){e.classList.add("form-invalid"),e.setAttribute("aria-invalid","true");let n=e.parentNode.querySelector(".form-error-message");n||(n=document.createElement("div"),n.className="form-error-message",n.style.color="#dc3545",n.style.fontSize="0.875em",n.style.marginTop="0.25rem",e.parentNode.appendChild(n)),n.textContent=t}function c(e){e.querySelectorAll(".form-invalid").forEach(e=>{e.classList.remove("form-invalid"),e.removeAttribute("aria-invalid")});e.querySelectorAll(".form-error-message").forEach(e=>e.remove())}class u{constructor(e={}){this.cache=new Map,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??500,autoValidation:e.autoValidation??!1,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Forms=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getForm(t),has:(e,t)=>e._hasForm(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasForm(t))return{enumerable:!0,configurable:!0,value:e._getForm(t)}}})}_getForm(e){if("string"!=typeof e)return this._warn("Invalid form property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,t._isEnhancedForm?t:this._enhanceForm(t);this.cache.delete(e)}const t=document.getElementById(e);if(t&&"form"===t.tagName.toLowerCase()){const n=t._isEnhancedForm?t:this._enhanceForm(t);return this._addToCache(e,n),this.stats.misses++,n}return this.stats.misses++,this.options.enableLogging&&this._warn(`Form with id '${e}' not found`),null}_hasForm(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}const t=document.getElementById(e);return t&&"form"===t.tagName.toLowerCase()}_getKeys(){const e=document.querySelectorAll("form[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_enhanceForm(n){if(!n||n._isEnhancedForm)return n;try{e.Elements&&e.Elements.helper?n=e.Elements.helper._enhanceElementWithUpdate(n):"undefined"!=typeof Elements&&Elements.helper&&(n=Elements.helper._enhanceElementWithUpdate(n))}catch(e){console.warn("[DOM Helpers Form] Could not enhance with Elements helper:",e.message)}return(n=t(n)).update?n.update=function(e){const t=e.update;return function(n={}){if(!n||"object"!=typeof n)return console.warn("[DOM Helpers Form] .update() called with invalid updates object"),e;const r={...n};if(r.values&&(s(e,r.values),delete r.values),r.validate){const t=!0===r.validate?{}:r.validate;a(e,t),delete r.validate}if(r.reset){const t=!0===r.reset?{}:r.reset;e.reset(t),delete r.reset}if(r.submit){const t=!0===r.submit?{}:r.submit;e.submitData(t),delete r.submit}return Object.keys(r).length>0?t.call(e,r):e}}(n):n.update=function(e={}){if(!e||"object"!=typeof e)return console.warn("[DOM Helpers Form] .update() called with invalid updates object"),n;const t={...e};if(t.values&&(s(n,t.values),delete t.values),t.validate){const e=!0===t.validate?{}:t.validate;a(n,e),delete t.validate}if(t.reset){const e=!0===t.reset?{}:t.reset;n.reset(e),delete t.reset}if(t.submit){const e=!0===t.submit?{}:t.submit;n.submitData(e),delete t.submit}return t.addEventListener&&("function"==typeof handleEnhancedEventListener?handleEnhancedEventListener(n,t.addEventListener):"object"==typeof t.addEventListener&&Object.entries(t.addEventListener).forEach(([e,t])=>{"function"==typeof t&&n.addEventListener(e,t)}),delete t.addEventListener),Object.entries(t).forEach(([e,t])=>{try{e in n?n[e]=t:"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||n.setAttribute(e,t)}catch(t){console.warn(`[DOM Helpers Form] Could not set ${e}:`,t.message)}}),n},Object.defineProperty(n,"_isEnhancedForm",{value:!0,writable:!1,enumerable:!1,configurable:!1}),n}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size}_initMutationObserver(){this.observer=new MutationObserver(e=>{this._processMutations(e)}),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&"form"===e.tagName.toLowerCase()&&e.id&&t.add(e.id)}),e.removedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&"form"===e.tagName.toLowerCase()&&e.id&&n.add(e.id)}),"attributes"===e.type&&"id"===e.attributeName){const s=e.target;if("form"===s.tagName.toLowerCase()){const r=e.oldValue,o=s.id;r&&r!==o&&n.add(r),o&&o!==r&&t.add(o)}}}),t.forEach(e=>{const t=document.getElementById(e);t&&"form"===t.tagName.toLowerCase()&&this._addToCache(e,t)}),n.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;const e=[];for(const[t,n]of this.cache)n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)&&n.id===t&&"form"===n.tagName.toLowerCase()||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_log(e){this.options.enableLogging&&console.log(`[Forms] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Forms] ${e}`)}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Forms helper destroyed")}getAllForms(){const e=document.querySelectorAll("form[id]");return Array.from(e).map(e=>e._isEnhancedForm?e:this._enhanceForm(e))}validateAll(e={}){const t={};return this.getAllForms().forEach(n=>{n.id&&(t[n.id]=n.validate(e[n.id]||{}))}),t}resetAll(){this.getAllForms().forEach(e=>e.reset())}}const d=new u({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:500}),h=d.Forms;h.helper=d,h.stats=()=>d.getStats(),h.clear=()=>d.clearCache(),h.destroy=()=>d.destroy(),h.getAllForms=()=>d.getAllForms(),h.validateAll=e=>d.validateAll(e),h.resetAll=()=>d.resetAll(),h.configure=e=>(Object.assign(d.options,e),h),"undefined"!=typeof module&&module.exports?module.exports={Forms:h,ProductionFormsHelper:u}:"function"==typeof define&&define.amd?define([],function(){return{Forms:h,ProductionFormsHelper:u}}):(e.Forms=h,e.ProductionFormsHelper=u),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{d.destroy()}),e.DOMHelpers&&(e.DOMHelpers.Forms=h,e.DOMHelpers.ProductionFormsHelper=u),console.log("[DOM Helpers Form] Form module loaded successfully")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Animation Module
 * Modular JavaScript Animations/Transitions helper that integrates seamlessly with DOM Helpers
 * 
 * Features:
 * - Declarative animation methods: fadeIn, fadeOut, slideUp, slideDown, slideToggle, transform
 * - Animation chaining support
 * - Configurable durations, delays, easing, and callbacks
 * - Compatible with .update({}) method from DOM Helpers
 * - Works with dynamic content (AJAX-loaded elements)
 * - Automatic cleanup of inline styles after animation completes
 * - Browser compatibility with graceful fallbacks
 * - Stays close to vanilla JavaScript using traditional DOM APIs
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";if(void 0===e.Elements&&"undefined"==typeof Elements)return void console.warn("[DOM Helpers Animation] Main DOM Helpers library must be loaded before the Animation module");const t={duration:300,delay:0,easing:"ease",cleanup:!0,queue:!0},n={linear:"linear",ease:"ease","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out","ease-in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","ease-out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","ease-in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","ease-in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","ease-out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","ease-in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","ease-in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","ease-out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","ease-in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","ease-in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","ease-out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","ease-in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","ease-in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","ease-out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","ease-in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","ease-in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","ease-out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","ease-in-out-expo":"cubic-bezier(1, 0, 0, 1)","ease-in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","ease-out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","ease-in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","ease-in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},s={transitions:function(){const e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(let n in t)if(void 0!==e.style[n])return{property:n,event:t[n]};return!1}(),transforms:function(){const e=document.createElement("div"),t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(let n=0;n<t.length;n++)if(void 0!==e.style[t[n]])return t[n];return!1}()};const r=new class{constructor(){this.queues=new WeakMap}add(e,t){this.queues.has(e)||this.queues.set(e,[]),this.queues.get(e).push(t),1===this.queues.get(e).length&&this.process(e)}process(e){const t=this.queues.get(e);if(!t||0===t.length)return;(0,t[0])().then(()=>{t.shift(),t.length>0&&this.process(e)}).catch(()=>{t.shift(),t.length>0&&this.process(e)})}clear(e){this.queues.has(e)&&this.queues.set(e,[])}isEmpty(e){const t=this.queues.get(e);return!t||0===t.length}};function o(e={}){const s={...t,...e};return"string"==typeof s.easing&&n[s.easing]&&(s.easing=n[s.easing]),s}function i(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function a(e,t){Object.entries(t).forEach(([t,n])=>{e.style[t]=n})}function l(e,t,n){const r=t.map(e=>`${e} ${n.duration}ms ${n.easing} ${n.delay}ms`).join(", ");s.transitions&&(e.style[s.transitions.property]=r)}function c(e,t){return new Promise(n=>{if(!s.transitions)return void setTimeout(n,t.duration+t.delay);let r=!1;const o=setTimeout(()=>{r||(r=!0,i(),n())},t.duration+t.delay+50),i=()=>{e.removeEventListener(s.transitions.event,a),clearTimeout(o)},a=t=>{t.target!==e||r||(r=!0,i(),n())};e.addEventListener(s.transitions.event,a)})}function u(e,t,n=[]){t.cleanup&&(s.transitions&&e.style.removeProperty(s.transitions.property),function(e,t){t.forEach(t=>{e.style.removeProperty(t)})}(e,n))}async function d(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{const s=i(e,"display");i(e,"opacity");"none"===s&&(e.style.display="block"),e.style.opacity="0",e.offsetHeight,l(e,["opacity"],n),e.style.opacity="1",await c(e,n),u(e,n,["opacity"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function h(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{i(e,"opacity");l(e,["opacity"],n),e.style.opacity="0",await c(e,n),!1!==n.hide&&(e.style.display="none"),u(e,n,!1!==n.hide?["opacity"]:[]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function p(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{const s=e.offsetHeight,r=i(e,"padding-top"),o=i(e,"padding-bottom"),d=i(e,"margin-top"),h=i(e,"margin-bottom");i(e,"overflow");a(e,{height:s+"px",paddingTop:r,paddingBottom:o,marginTop:d,marginBottom:h,overflow:"hidden"}),e.offsetHeight,l(e,["height","padding-top","padding-bottom","margin-top","margin-bottom"],n),a(e,{height:"0px",paddingTop:"0px",paddingBottom:"0px",marginTop:"0px",marginBottom:"0px"}),await c(e,n),e.style.display="none",u(e,n,["height","padding-top","padding-bottom","margin-top","margin-bottom","overflow"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function f(e,t={}){const n=o(t);return new Promise(async(t,s)=>{try{"none"===i(e,"display")&&(e.style.display="block");const s=e.offsetHeight,r=i(e,"padding-top"),o=i(e,"padding-bottom"),d=i(e,"margin-top"),h=i(e,"margin-bottom");a(e,{height:"0px",paddingTop:"0px",paddingBottom:"0px",marginTop:"0px",marginBottom:"0px",overflow:"hidden"}),e.offsetHeight,l(e,["height","padding-top","padding-bottom","margin-top","margin-bottom"],n),a(e,{height:s+"px",paddingTop:r,paddingBottom:o,marginTop:d,marginBottom:h}),await c(e,n),u(e,n,["height","padding-top","padding-bottom","margin-top","margin-bottom","overflow"]),"function"==typeof n.onComplete&&n.onComplete(e),t(e)}catch(e){s(e)}})}async function m(e,t={}){const n=o(t);return"none"!==i(e,"display")&&e.offsetHeight>0?p(e,n):f(e,n)}async function y(e,t,n={}){const r=o(n);return new Promise(async(n,o)=>{try{if(!s.transforms)return console.warn("[DOM Helpers Animation] Transform not supported in this browser"),void setTimeout(()=>n(e),r.duration+r.delay);let o="";Object.entries(t).forEach(([e,t])=>{switch(e){case"translateX":case"translateY":case"translateZ":case"scale":case"scaleX":case"scaleY":case"scaleZ":case"rotate":case"rotateX":case"rotateY":case"rotateZ":case"skew":case"skewX":case"skewY":o+=`${e}(${t}) `;break;case"translate":Array.isArray(t)?o+=`translate(${t[0]}, ${t[1]}) `:o+=`translate(${t}) `;break;case"translate3d":Array.isArray(t)&&t.length>=3&&(o+=`translate3d(${t[0]}, ${t[1]}, ${t[2]}) `);break;default:console.warn(`[DOM Helpers Animation] Unknown transform property: ${e}`)}}),l(e,[s.transforms],r),e.style[s.transforms]=o.trim(),await c(e,r),r.cleanup&&u(e,r,[s.transforms]),"function"==typeof r.onComplete&&r.onComplete(e),n(e)}catch(e){o(e)}})}class g{constructor(e){this.element=e,this.animations=[]}fadeIn(e={}){return this.animations.push(()=>d(this.element,e)),this}fadeOut(e={}){return this.animations.push(()=>h(this.element,e)),this}slideUp(e={}){return this.animations.push(()=>p(this.element,e)),this}slideDown(e={}){return this.animations.push(()=>f(this.element,e)),this}slideToggle(e={}){return this.animations.push(()=>m(this.element,e)),this}transform(e,t={}){return this.animations.push(()=>y(this.element,e,t)),this}delay(e){return this.animations.push(()=>new Promise(t=>setTimeout(t,e))),this}then(e){return this.animations.push(()=>"function"==typeof e?Promise.resolve(e(this.element)):Promise.resolve()),this}async play(){try{for(const e of this.animations)await e();return this.element}catch(e){throw console.error("[DOM Helpers Animation] Chain execution failed:",e),e}}}function b(e){return!e||e._hasAnimationMethods||(Object.defineProperty(e,"_hasAnimationMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e.fadeIn=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>d(e,t).then(n))}):d(e,t)},e.fadeOut=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>h(e,t).then(n))}):h(e,t)},e.slideUp=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>p(e,t).then(n))}):p(e,t)},e.slideDown=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>f(e,t).then(n))}):f(e,t)},e.slideToggle=function(t={}){return o(t).queue&&!r.isEmpty(e)?new Promise(n=>{r.add(e,()=>m(e,t).then(n))}):m(e,t)},e.transform=function(t,n={}){return o(n).queue&&!r.isEmpty(e)?new Promise(s=>{r.add(e,()=>y(e,t,n).then(s))}):y(e,t,n)},e.animate=function(){return new g(e)},e.stopAnimations=function(){return r.clear(e),s.transitions&&e.style.removeProperty(s.transitions.property),e}),e}function E(e){if(!e||e._hasAnimationMethods)return e;function t(t,n={}){const s=e._originalCollection||e._originalNodeList||e,r=Array.from(s).map((e,s)=>{if(e&&e.nodeType===Node.ELEMENT_NODE){const r={...n};return n.stagger&&s>0&&(r.delay=(r.delay||0)+n.stagger*s),e._hasAnimationMethods||b(e),t(e,r)}return Promise.resolve()});return Promise.all(r).then(()=>e)}return Object.defineProperty(e,"_hasAnimationMethods",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e.fadeIn=function(e={}){return t(d,e)},e.fadeOut=function(e={}){return t(h,e)},e.slideUp=function(e={}){return t(p,e)},e.slideDown=function(e={}){return t(f,e)},e.slideToggle=function(e={}){return t(m,e)},e.transform=function(e,n={}){return t((t,n)=>y(t,e,n),n)},e.stopAnimations=function(){const t=e._originalCollection||e._originalNodeList||e;return Array.from(t).forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&(r.clear(e),s.transitions&&e.style.removeProperty(s.transitions.property))}),e},e}function w(e,t=!1){return function(t={}){if(!t||"object"!=typeof t)return console.warn("[DOM Helpers Animation] .update() called with invalid updates object"),this;const n={...t},s=[];if(void 0!==n.fadeIn){const e=!0===n.fadeIn?{}:n.fadeIn;s.push(this.fadeIn(e)),delete n.fadeIn}if(void 0!==n.fadeOut){const e=!0===n.fadeOut?{}:n.fadeOut;s.push(this.fadeOut(e)),delete n.fadeOut}if(void 0!==n.slideUp){const e=!0===n.slideUp?{}:n.slideUp;s.push(this.slideUp(e)),delete n.slideUp}if(void 0!==n.slideDown){const e=!0===n.slideDown?{}:n.slideDown;s.push(this.slideDown(e)),delete n.slideDown}if(void 0!==n.slideToggle){const e=!0===n.slideToggle?{}:n.slideToggle;s.push(this.slideToggle(e)),delete n.slideToggle}if(void 0!==n.transform){const{transformations:e,options:t={}}=n.transform;e&&s.push(this.transform(e,t)),delete n.transform}n.stopAnimations&&(this.stopAnimations(),delete n.stopAnimations);let r=this;return Object.keys(n).length>0&&e&&(r=e.call(this,n)),s.length>0?Promise.all(s).then(()=>r):r}}const v={fadeIn:d,fadeOut:h,slideUp:p,slideDown:f,slideToggle:m,transform:y,setDefaults:function(e){return Object.assign(t,e),this},getDefaults:function(){return{...t}},isSupported:function(e){switch(e){case"transitions":return!!s.transitions;case"transforms":return!!s.transforms;default:return!1}},clearQueue:function(e){return r.clear(e),this},enhance:function(e){return e&&e.nodeType===Node.ELEMENT_NODE?b(e):e&&(void 0!==e.length||e._originalCollection||e._originalNodeList)?E(e):e},chain:function(e){return new g(e)},easing:n,version:"1.0.0"};void 0!==e.Elements||void 0!==e.Collections||void 0!==e.Selector?(!function(){if(e.Elements&&e.Elements.helper){const t=e.Elements.helper._enhanceElementWithUpdate;t&&(e.Elements.helper._enhanceElementWithUpdate=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=w(t,!1)}return e});const n=e.Elements;if(n&&"object"==typeof n)try{if(e.Elements.helper&&e.Elements.helper._getElement){const t=e.Elements.helper._getElement;e.Elements.helper._getElement=function(e){const n=t.call(this,e);return n&&n.nodeType===Node.ELEMENT_NODE&&!n._hasAnimationMethods?b(n):n}}}catch(e){console.warn("[DOM Helpers Animation] Could not enhance Elements proxy:",e.message)}}if(e.Collections&&e.Collections.helper){const t=e.Collections.helper._enhanceCollectionWithUpdate;t&&(e.Collections.helper._enhanceCollectionWithUpdate=function(e){if((e=E(e=t.call(this,e))).update){const t=e.update;e.update=w(t,!0)}return e})}if(e.Selector&&e.Selector.helper){const t=e.Selector.helper._enhanceElementWithUpdate;t&&(e.Selector.helper._enhanceElementWithUpdate=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=w(t,!1)}return e});const n=e.Selector.helper._enhanceCollectionWithUpdate;n&&(e.Selector.helper._enhanceCollectionWithUpdate=function(e){if((e=E(e=n.call(this,e))).update){const t=e.update;e.update=w(t,!0)}return e})}if(e.Forms&&e.Forms.helper){const t=e.Forms.helper._enhanceForm;t&&(e.Forms.helper._enhanceForm=function(e){if((e=b(e=t.call(this,e))).update){const t=e.update;e.update=w(t,!1)}return e})}}(),console.log("[DOM Helpers Animation] Animation module integrated successfully")):console.log("[DOM Helpers Animation] Animation module loaded in standalone mode"),"undefined"!=typeof module&&module.exports?module.exports={Animation:v}:"function"==typeof define&&define.amd?define([],function(){return{Animation:v}}):e.Animation=v,e.DOMHelpers&&(e.DOMHelpers.Animation=v)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers Components - Traditional HTML5 Component System
 * Extends DOM Helpers with vanilla JavaScript component architecture
 * Fully compatible with all DOM Helpers libraries (async, form, storage, animation)
 * 
 * Features:
 * - Traditional HTML5 structure with IDs and classes
 * - Seamless Elements, Collections, Selector integration
 * - Component-based architecture with vanilla JavaScript
 * - Scoped CSS with automatic isolation
 * - Event delegation and custom events
 * - Full DOM Helpers .update() compatibility
 * - Lifecycle management
 * - Data binding through DOM Helpers philosophy
 * 
 * @version 2.0.0
 * @license MIT
 */
function(e){"use strict";const t=["Elements","Collections","Selector"].filter(t=>void 0===e[t]);t.length>0&&console.warn("[DOM Components] Missing DOM Helpers libraries:",t.join(", "));const n=new Map,s=new WeakMap,r=new Map,o=new WeakMap;let i=0;class a{constructor(e,t,n,r={}){this.id="comp-"+ ++i,this.name=e,this.definition=t,this.container=n,this.data={...r},this.children=new Set,this.isDestroyed=!1,this.isMounted=!1,this.scopeId=`data-component-${this.id}`,this.lifecycle={beforeMount:[],mounted:[],beforeUpdate:[],updated:[],beforeDestroy:[],destroyed:[]},this._parseDefinition(),s.set(n,this),o.set(this,this.data)}_parseDefinition(){"string"==typeof this.definition?(this.template=this._extractTemplate(this.definition),this.styles=this._extractStyles(this.definition),this.script=this._extractScript(this.definition)):"object"==typeof this.definition&&(this.template=this.definition.template||"",this.styles=this.definition.styles||"",this.script=this.definition.script||"")}_extractTemplate(e){return e.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").trim()}_extractStyles(e){const t=e.match(/<style[^>]*>([\s\S]*?)<\/style>/i);return t?t[1].trim():""}_extractScript(e){const t=e.match(/<script[^>]*>([\s\S]*?)<\/script>/i);return t?t[1].trim():""}async render(){if(!this.isDestroyed)try{return await this._callLifecycle("beforeMount"),this.styles&&this._injectScopedStyles(),this._createDOM(),this.styles&&this._applyScopeAttributes(),this.script&&await this._executeScript(),await this._processNestedComponents(),this._enhanceWithDOMHelpers(),this.isMounted=!0,await this._callLifecycle("mounted"),this}catch(e){throw console.error(`[DOM Components] Error rendering component ${this.name}:`,e),e}}_createDOM(){this.container.innerHTML="",this.container.innerHTML=this.template,this.root=1===this.container.children.length?this.container.firstElementChild:this.container}_injectScopedStyles(){if(r.has(this.scopeId))return;const e=this._scopeCSS(this.styles),t=document.createElement("style");t.setAttribute("data-component",this.name),t.setAttribute("data-scope",this.scopeId),t.textContent=e,document.head.appendChild(t),r.set(this.scopeId,t)}_scopeCSS(e){return e.replace(/([^{}]+)\{/g,(e,t)=>{const n=t.trim();if(n.startsWith("@")||n.startsWith("/*")||n.includes("keyframes"))return e;return`${n.split(",").map(e=>`[${this.scopeId}] ${e.trim()}`).join(", ")} {`})}_applyScopeAttributes(){this.container.setAttribute(this.scopeId,"");this.container.querySelectorAll("*").forEach(e=>{e.setAttribute(this.scopeId,"")})}async _executeScript(){try{const t={component:this,container:this.container,root:this.root,data:this.data,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,getData:()=>this.data,setData:e=>this.updateData(e),emit:(e,t)=>this.emit(e,t),destroy:()=>this.destroy(),onBeforeMount:e=>this.lifecycle.beforeMount.push(e),onMounted:e=>this.lifecycle.mounted.push(e),onBeforeUpdate:e=>this.lifecycle.beforeUpdate.push(e),onUpdated:e=>this.lifecycle.updated.push(e),onBeforeDestroy:e=>this.lifecycle.beforeDestroy.push(e),onDestroyed:e=>this.lifecycle.destroyed.push(e),console:console,setTimeout:setTimeout,setInterval:setInterval,clearTimeout:clearTimeout,clearInterval:clearInterval,fetch:"undefined"!=typeof fetch?fetch:void 0,...e.DOMHelpersAsync?{Async:e.DOMHelpersAsync}:{},...e.DOMHelpersForm?{Form:e.DOMHelpersForm}:{},...e.DOMHelpersStorage?{Storage:e.DOMHelpersStorage}:{},...e.DOMHelpersAnimation?{Animation:e.DOMHelpersAnimation}:{}},n=new Function(...Object.keys(t),this.script);await n.apply(this,Object.values(t))}catch(e){throw console.error(`[DOM Components] Error executing script for ${this.name}:`,e),e}}async _processNestedComponents(){const e=this.container.querySelectorAll("[data-component]");for(const t of e){const e=t.getAttribute("data-component");if(e&&c.isRegistered(e))try{const n=this._extractDataFromElement(t),s=await c.render(e,t,n);s&&this.children.add(s)}catch(t){console.error(`[DOM Components] Error rendering nested component ${e}:`,t)}}}_extractDataFromElement(e){const t={};return Array.from(e.attributes).forEach(e=>{if("data-component"!==e.name){const n=e.name.replace(/^data-/,"").replace(/-([a-z])/g,(e,t)=>t.toUpperCase());let s=e.value;try{"true"===s?s=!0:"false"===s?s=!1:isNaN(s)||""===s?(s.startsWith("{")&&s.endsWith("}")||s.startsWith("[")&&s.endsWith("]"))&&(s=JSON.parse(s)):s=Number(s)}catch(e){}t[n]=s}}),t}_enhanceWithDOMHelpers(){this.container.querySelectorAll("*").forEach(t=>{e.EnhancedUpdateUtility&&e.EnhancedUpdateUtility.enhanceElementWithUpdate&&e.EnhancedUpdateUtility.enhanceElementWithUpdate(t)}),e.EnhancedUpdateUtility&&e.EnhancedUpdateUtility.enhanceElementWithUpdate&&e.EnhancedUpdateUtility.enhanceElementWithUpdate(this.container)}async updateData(e){if(!this.isDestroyed)try{await this._callLifecycle("beforeUpdate");const t={...this.data};Object.assign(this.data,e),o.set(this,this.data),this.emit("dataChanged",{oldData:t,newData:this.data,changes:e}),await this._callLifecycle("updated")}catch(e){console.error(`[DOM Components] Error updating component ${this.name}:`,e)}}_deepMergeUpdates(e,t){Object.entries(t).forEach(([t,n])=>{if("object"!=typeof n||null===n||Array.isArray(n))e[t]=n;else{Object.keys(n).some(e=>"style"===e||"dataset"===e)&&e[t]?(e[t]=e[t]||{},Object.entries(n).forEach(([n,s])=>{e[t][n]="style"!==n&&"dataset"!==n||"object"!=typeof s?s:{...e[t][n],...s}})):e[t]=n}})}update(e,t={}){this.isDestroyed||(this._updateQueue||(this._updateQueue={},this._updateScheduled=!1),this._deepMergeUpdates(this._updateQueue,e),t.immediate?this._flushUpdates():this._updateScheduled||(this._updateScheduled=!0,"undefined"!=typeof requestAnimationFrame?this._rafId=requestAnimationFrame(()=>{this._flushUpdates()}):this._rafId=setTimeout(()=>{this._flushUpdates()},16)))}_flushUpdates(){if(this.isDestroyed||!this._updateQueue)return;const e=this._updateQueue;this._updateQueue={},this._updateScheduled=!1;try{this._applyUpdatesWithCoreSystem(e)}catch(e){console.error(`[DOM Components] Error flushing updates for ${this.name}:`,e)}}_applyUpdatesWithCoreSystem(e){if(!("undefined"!=typeof applyEnhancedUpdate))return console.warn("[DOM Components] Core fine-grained update system not available, using fallback"),this._applyUpdatesFallback(e);Object.entries(e).forEach(([e,t])=>{if(e.includes(".")){const n=e.indexOf("."),s=e.substring(0,n),r=e.substring(n+1),o=this.container.querySelector(`#${s}`)||("undefined"!=typeof Elements?Elements[s]:null);if(!o)return;if(r.includes(".")){const e=r.split(".");let n=o;for(let t=0;t<e.length-1;t++){if(!n[e[t]])return;n=n[e[t]]}n[e[e.length-1]]=t}else{({})[r]=t,applyEnhancedUpdate(o,r,t)}}else{const n=this.container.querySelector(`#${e}`)||("undefined"!=typeof Elements?Elements[e]:null);if(!n)return;"object"!=typeof t||null===t||Array.isArray(t)?applyEnhancedUpdate(n,"textContent",t):Object.entries(t).forEach(([e,t])=>{applyEnhancedUpdate(n,e,t)})}})}_applyUpdatesFallback(e){Object.entries(e).forEach(([e,t])=>{if(e.includes(".")){const[n,...s]=e.split("."),r=this.container.querySelector(`#${n}`);if(r){let e=r;for(let t=0;t<s.length-1;t++){if(!e[s[t]])return void console.warn(`[DOM Components] Property "${s[t]}" not found on element "${n}"`);e=e[s[t]]}const o=s[s.length-1];e[o]!==t&&(e[o]=t)}}else{const n=this.container.querySelector(`#${e}`);n&&"object"==typeof t&&null!==t&&Object.entries(t).forEach(([e,t])=>{"style"===e&&"object"==typeof t?Object.entries(t).forEach(([e,t])=>{n.style[e]!==t&&(n.style[e]=t)}):"classList"===e&&"object"==typeof t?Object.entries(t).forEach(([e,t])=>{const s=Array.isArray(t)?t:[t];"function"==typeof n.classList[e]&&s.forEach(t=>n.classList[e](t))}):"dataset"===e&&"object"==typeof t?Object.entries(t).forEach(([e,t])=>{n.dataset[e]!==t&&(n.dataset[e]=t)}):n[e]!==t&&(n[e]=t)})}})}async refresh(){if(!this.isDestroyed)try{await this._callLifecycle("beforeUpdate"),await this.render(),await this._callLifecycle("updated")}catch(e){console.error(`[DOM Components] Error refreshing component ${this.name}:`,e)}}async smartUpdate(e,t=null){if(!this.isDestroyed)try{await this.updateData(e),t&&this.update(t)}catch(e){console.error(`[DOM Components] Error in smart update for ${this.name}:`,e)}}emit(e,t={}){const n=new CustomEvent(`component:${e}`,{detail:{component:this,componentName:this.name,data:t},bubbles:!0,cancelable:!0});this.container.dispatchEvent(n),document.dispatchEvent(n)}on(e,t){this.lifecycle[e]&&this.lifecycle[e].push(t)}async _callLifecycle(e){const t=this.lifecycle[e]||[];for(const n of t)try{await n.call(this)}catch(t){console.error(`[DOM Components] Error in ${e} lifecycle:`,t)}}async destroy(){if(!this.isDestroyed)try{await this._callLifecycle("beforeDestroy"),this._updateScheduled&&this._rafId&&("undefined"!=typeof cancelAnimationFrame&&cancelAnimationFrame(this._rafId),this._updateScheduled=!1),this._updateQueue&&(this._updateQueue={});for(const e of this.children)await e.destroy();if(this.children.clear(),r.has(this.scopeId)){const e=r.get(this.scopeId);e.parentNode&&e.parentNode.removeChild(e),r.delete(this.scopeId)}this.container&&(this.container.innerHTML=""),s.delete(this.container),o.delete(this),this.isDestroyed=!0,this.isMounted=!1,await this._callLifecycle("destroyed")}catch(e){console.error(`[DOM Components] Error destroying component ${this.name}:`,e)}}}function l(e){return e?new Proxy(e,{get:(e,t)=>"update"===t?function(e){return function(e){return{_isUpdateCall:!0,_updates:e}}(e)}:e[t]}):null}const c={update:function(e={}){e&&"object"==typeof e?Object.entries(e).forEach(([e,t])=>{if(e.includes(".")){const n=e.indexOf("."),s=e.substring(0,n),r=e.substring(n+1),o=Elements[s];if(o)if(r.includes(".")){const e=r.split(".");let n=o;for(let t=0;t<e.length-1;t++){if(!n[e[t]])return void console.warn(`[DOM Components] Property "${e[t]}" not found on element "${s}"`);n=n[e[t]]}n[e[e.length-1]]=t}else r in o?o[r]=t:o.setAttribute(r,t);else console.warn(`[DOM Components] Element with id "${s}" not found`)}else{const n=Elements[e];n?"object"!=typeof t||null===t||Array.isArray(t)?console.warn(`[DOM Components] Invalid update value for element "${e}"`):t._isUpdateCall?n.update(t._updates):n.update(t):console.warn(`[DOM Components] Element with id "${e}" not found`)}}):console.warn("[DOM Components] .update() called with invalid updates object")},register(e,t){if("string"!=typeof e)throw new Error("[DOM Components] Component name must be a string");return n.has(e)&&console.warn(`[DOM Components] Component "${e}" already registered. Overwriting.`),n.set(e,t),console.log(`[DOM Components] Component "${e}" registered`),this},async load(e,t){try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const s=await n.text();return this.register(e,s),this}catch(n){throw console.error(`[DOM Components] Failed to load component "${e}" from ${t}:`,n),n}},async render(e,t,r={}){if(!n.has(e))throw new Error(`[DOM Components] Component "${e}" not registered`);if("string"==typeof t&&!(t=Elements[t]||document.querySelector(t)))throw new Error(`[DOM Components] Container not found: ${t}`);const o=s.get(t);o&&await o.destroy();const i=n.get(e),l=new a(e,i,t,r);return await l.render(),l},async renderInline(e,t,n={}){const s=`inline-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return this.register(s,e),this.render(s,t,n)},scope(...e){const t={};return 0===e.length?new Proxy({},{get(e,t){if("string"==typeof t){return l(Elements[t])}}}):(e.forEach(e=>{const n=Elements[e];n?t[e]=l(n):(console.warn(`[DOM Components] Element "${e}" not found in scope`),t[e]=null)}),t)},batchUpdate(e){if(e&&"object"==typeof e)return Object.entries(e).forEach(([e,t])=>{const n=Elements[e];if(n&&"function"==typeof n.update)try{n.update(t)}catch(t){console.error(`[DOM Components] Error updating element "${e}":`,t)}else n||console.warn(`[DOM Components] Element "${e}" not found for batchUpdate`)}),this;console.warn("[DOM Components] batchUpdate called with invalid updates object")},createBinding:(e,t)=>({update(e){const n=t(e);c.batchUpdate(n)},elements:e.reduce((e,t)=>(e[t]=Elements[t],e),{})}),getInstance:e=>("string"==typeof e&&(e=Elements[e]||document.querySelector(e)),s.get(e)),async destroy(e){const t=this.getInstance(e);return!!t&&(await t.destroy(),!0)},isRegistered:e=>n.has(e),getRegistered:()=>Array.from(n.keys()),unregister(e){const t=n.delete(e);return t&&console.log(`[DOM Components] Component "${e}" unregistered`),t},async autoInit(e=document){const t=e.querySelectorAll("[data-component]");for(const e of t){const t=e.getAttribute("data-component");if(t&&this.isRegistered(t)&&!s.has(e))try{const n=this._extractDataFromElement(e);await this.render(t,e,n)}catch(e){console.error(`[DOM Components] Auto-init failed for ${t}:`,e)}}await this._processCustomTags(e)},async _processCustomTags(e=document){const t=e.querySelectorAll("*"),n=Array.from(t).filter(e=>{const t=e.tagName.toLowerCase();return this._isComponentTag(t)&&!s.has(e)});for(const e of n){const t=e.tagName.toLowerCase(),n=this._tagNameToComponentName(t);if(this.isRegistered(n))try{const t=this._extractPropsFromElement(e),s=document.createElement("div");s.className=`${n.toLowerCase()}-container`,e.parentNode.replaceChild(s,e),await this.render(n,s,t)}catch(e){console.error(`[DOM Components] Error processing custom tag <${t}>:`,e)}}},_isComponentTag:e=>!new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"]).has(e)&&(e.includes("-")?/^[a-z]+(-[a-z0-9]+)+$/.test(e):/^[a-z][a-z0-9]*$/.test(e)&&e.length>2),_tagNameToComponentName(e){if(e.includes("-"))return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");{if(this.isRegistered(e))return e;const t=e.charAt(0).toUpperCase()+e.slice(1);if(this.isRegistered(t))return t;const n=this.getRegistered(),s=e.toLowerCase();for(const e of n)if(e.toLowerCase()===s)return e;return t}},_extractPropsFromElement(e){const t={};return Array.from(e.attributes).forEach(e=>{const n=this._attributeNameToPropName(e.name);let s=e.value;try{"true"===s?s=!0:"false"===s?s=!1:"null"===s?s=null:"undefined"===s?s=void 0:isNaN(s)||""===s||isNaN(Number(s))?(s.startsWith("{")&&s.endsWith("}")||s.startsWith("[")&&s.endsWith("]"))&&(s=JSON.parse(s)):s=Number(s)}catch(e){}t[n]=s}),e.innerHTML.trim()&&(t.children=e.innerHTML.trim()),t},_attributeNameToPropName:e=>e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),async processHTML(e,t){const n=document.createElement("div");if(n.innerHTML=e,await this._processCustomTags(n),t)for(t.innerHTML="";n.firstChild;)t.appendChild(n.firstChild);return n.innerHTML},_extractDataFromElement(e){const t={};return Array.from(e.attributes).forEach(e=>{if("data-component"!==e.name&&e.name.startsWith("data-")){const n=e.name.replace(/^data-/,"").replace(/-([a-z])/g,(e,t)=>t.toUpperCase());let s=e.value;try{"true"===s?s=!0:"false"===s?s=!1:isNaN(s)||""===s?(s.startsWith("{")&&s.endsWith("}")||s.startsWith("[")&&s.endsWith("]"))&&(s=JSON.parse(s)):s=Number(s)}catch(e){}t[n]=s}}),t},getStats:()=>({registered:n.size,active:Array.from(s.values()).filter(e=>!e.isDestroyed).length,scopedStyles:r.size}),async destroyAll(){const e=Array.from(s.values());for(const t of e)t.isDestroyed||await t.destroy()},configure(e={}){return this}};"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>c.autoInit(),0)}):setTimeout(()=>c.autoInit(),0),window.addEventListener("beforeunload",()=>{c.destroyAll()})),void 0!==e.Elements&&e.Elements&&(e.Elements.update=c.update,console.log("[DOM Components] Elements.update() enhanced with dot notation support")),"undefined"!=typeof module&&module.exports?module.exports={Components:c,Component:a}:"function"==typeof define&&define.amd?define([],function(){return{Components:c,Component:a}}):(e.Components=c,e.Component=a),console.log("[DOM Components] Traditional HTML5 component system loaded")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers - Reactive State Extension
 * Smart reactivity system for declarative DOM updates
 * 
 * Features:
 * - Reactive state with Proxy (nested objects/arrays)
 * - Unified binding API across Elements, Collections, Selector
 * - Fine-grained updates with dependency tracking
 * - Automatic cleanup with WeakMap and MutationObserver
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";if(!e.Elements||!e.Collections||!e.Selector)return void console.error("[DOM Helpers Reactive] Core DOM Helpers library must be loaded first");const t=new WeakMap;let n=null;const s=new WeakMap,r=(new WeakMap,new WeakMap);function o(e,s=[],l=null){if(null===e||"object"!=typeof e)return e;if(t.has(e))return e;if(r.has(e))return r.get(e);const c=new Proxy(e,{get(e,l){n&&function(e,n,s){const r=t.get(e);if(!r)return;r.dependencies.has(n)||r.dependencies.set(n,new Set);r.dependencies.get(n).add(s)}(c,l,n);const u=e[l];if(Array.isArray(e)&&"function"==typeof u)return function(...n){const s=u.apply(e,n);if(["push","pop","shift","unshift","splice","sort","reverse"].includes(l)){i(c,"length");const e=t.get(c);e&&e.dependencies.size>0&&e.dependencies.forEach((e,t)=>{e.forEach(e=>{try{a(e)}catch(e){console.error("[DOM Helpers Reactive] Error executing binding:",e)}})})}return s};if(null!==u&&"object"==typeof u){if(!r.has(u)){const e=o(u,[...s,l],c);r.set(u,e)}return r.get(u)}return u},set(e,n,a){if(e[n]===a)return!0;if(null===a||"object"!=typeof a||t.has(a))e[n]=a;else{const t=o(a,[...s,n],c);r.set(a,t),e[n]=a}return i(c,n),!0},deleteProperty:(e,t)=>(t in e&&(delete e[t],i(c,t)),!0)});return t.set(c,{target:e,path:s,parent:l,dependencies:new Map}),r.set(e,c),c}function i(e,n){const s=t.get(e);if(!s)return;const r=s.dependencies.get(n);r&&r.forEach(e=>{try{a(e)}catch(e){console.error("[DOM Helpers Reactive] Error executing binding:",e)}})}function a(e){const{element:t,property:s,fn:r,lastValue:o}=e;if(!document.contains(t))return void u(e);const i=n;n=e;try{const n=r();if(c(n,o))return;e.lastValue=l(n),function(e,t,n){if(null==n)return void("textContent"===t&&(e.textContent=""));if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void(t?"style"===t&&"string"==typeof n?e.style.cssText=n:t in e?e[t]=n:e.setAttribute(t,n):e.textContent=String(n));if(Array.isArray(n))return void(t?e[t]=n:e.textContent=n.join(", "));if(n instanceof Node)return void(t?console.warn("[DOM Helpers Reactive] Cannot assign DOM node to property:",t):(e.innerHTML="",e.appendChild(n)));"object"==typeof n&&(t?"style"===t?Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)}):"dataset"===t?Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n}):e[t]=n:Object.entries(n).forEach(([t,n])=>{"style"===t&&"object"==typeof n?Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)}):"dataset"===t&&"object"==typeof n?Object.entries(n).forEach(([t,n])=>{e.dataset[t]=n}):t in e?e[t]=n:e.setAttribute(t,n)}))}(t,s,n)}finally{n=i}}function l(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>l(e));if(e instanceof Node)return e;const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=l(e[n]));return t}function c(e,t){if(e===t)return!0;if(null==e||null==t)return e===t;if(typeof e!=typeof t)return!1;if("object"==typeof e){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,n)=>c(e,t[n]));if(e instanceof Node||t instanceof Node)return e===t;const n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every(n=>c(e[n],t[n]))}return!1}function u(e){const{element:t}=e;s.has(t)&&s.get(t).delete(e)}function d(e,t,n){const r={element:e,property:t,fn:n,lastValue:void 0};return function(e){return s.has(e)||s.set(e,new Set),s.get(e)}(e).add(r),a(r),r}function h(e,t){"function"==typeof t?d(e,null,t):"object"==typeof t&&null!==t&&Object.entries(t).forEach(([t,n])=>{"function"==typeof n&&d(e,t,n)})}function p(e){document.querySelectorAll(e).forEach(e=>f(e))}function f(e){if(!s.has(e))return;s.get(e).forEach(e=>u(e)),s.delete(e)}const m=function(){const e=new MutationObserver(e=>{e.forEach(e=>{e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){f(e);e.querySelectorAll("*").forEach(e=>f(e))}})})});return document.body?e.observe(document.body,{childList:!0,subtree:!0}):document.addEventListener("DOMContentLoaded",()=>{e.observe(document.body,{childList:!0,subtree:!0})}),e}(),y={create:e=>o(e)};if(e.Elements&&(e.Elements.state=function(e){return o(e)},e.Elements.bind=function(e){Object.entries(e).forEach(([e,t])=>{const n=document.getElementById(e);n?h(n,t):console.warn(`[DOM Helpers Reactive] Element with id "${e}" not found`)})},e.Elements.unbind=function(e){const t=document.getElementById(e);t&&f(t)}),e.Collections&&(e.Collections.bind=function(e){Object.entries(e).forEach(([e,t])=>{const n=document.getElementsByClassName(e);Array.from(n).forEach(e=>{h(e,t)})})},e.Collections.unbind=function(e){const t=document.getElementsByClassName(e);Array.from(t).forEach(e=>f(e))}),e.Selector&&e.Selector.query){const t=e.Selector.query;t.bind=function(e){Object.entries(e).forEach(([e,t])=>{const n=document.querySelector(e);n?h(n,t):console.warn(`[DOM Helpers Reactive] No element found for selector "${e}"`)})},t.unbind=p}if(e.Selector&&e.Selector.queryAll){const t=e.Selector.queryAll;t.bind=function(e){Object.entries(e).forEach(([e,t])=>{document.querySelectorAll(e).forEach(e=>{h(e,t)})})},t.unbind=p}e.ReactiveState=y,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{m&&m.disconnect()}),console.log("[DOM Helpers Reactive] Reactive state system loaded successfully")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),
/**
 * DOM Helpers Async Module
 * High-performance vanilla JavaScript async utilities with seamless DOM integration
 * 
 * Features:
 * - Debounce & Throttle utilities
 * - Enhanced Fetch with error handling, retries, timeouts
 * - Form submission helpers with validation
 * - Input sanitization for XSS protection
 * - Async event handlers
 * - Parallel request management
 * - Full integration with Elements, Collections, and Selector
 * 
 * @version 1.0.0
 * @license MIT
 */
function(e){"use strict";function t(e,t=300,n={}){if("function"!=typeof e)throw new Error("[DOM Helpers Async] debounce: func must be a function");const{immediate:s=!1,maxWait:r=null}=n;let o=null,i=null,a=null;const l=function(...n){const l=s&&!o,c=Date.now();null===a&&(a=c);const u=()=>{o&&(clearTimeout(o),o=null),i&&(clearTimeout(i),i=null)},d=()=>(a=null,u(),e.apply(this,n));return u(),l?d():(o=setTimeout(d,t),r&&c-a>=r?d():void(r&&!i&&(i=setTimeout(d,r-(c-a)))))};return l.cancel=()=>{o&&(clearTimeout(o),o=null),i&&(clearTimeout(i),i=null),a=null},l.flush=function(...t){if(o||i){const n=e.apply(this,t);return l.cancel(),n}},l}function n(e,t=200,n={}){if("function"!=typeof e)throw new Error("[DOM Helpers Async] throttle: func must be a function");const{leading:s=!0,trailing:r=!0}=n;let o=null,i=null,a=null;const l=function(...n){const l=Date.now();o||s||(o=l);const c=t-(l-(o||0));return c<=0||c>t?(i&&(clearTimeout(i),i=null),o=l,a=e.apply(this,n)):!i&&r&&(i=setTimeout(()=>{o=s?Date.now():null,i=null,a=e.apply(this,n)},c)),a};return l.cancel=()=>{i&&(clearTimeout(i),i=null),o=null,a=null},l}function s(e,t={}){if("string"!=typeof e)return e;const{allowedTags:n=[],allowedAttributes:s=[],removeScripts:r=!0,removeEvents:o=!0,removeStyles:i=!1}=t;let a=e;if(r&&(a=a.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),a=a.replace(/javascript:/gi,""),a=a.replace(/on\w+\s*=/gi,"")),o&&(a=a.replace(/\s*on[a-z]+\s*=\s*["'][^"']*["']/gi,"")),i&&(a=a.replace(/\s*style\s*=\s*["'][^"']*["']/gi,"")),n.length>0){const e=new RegExp(`<(?!/?(?:${n.join("|")})\\b)[^>]+>`,"gi");a=a.replace(e,"")}else a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;");return a}function r(e){return new Promise(t=>setTimeout(t,e))}async function o(e,t={}){const{method:n="GET",headers:s={},body:o=null,timeout:i=1e4,retries:a=0,retryDelay:l=1e3,loadingIndicator:c=null,onSuccess:u=null,onError:d=null,onStart:h=null,onFinally:p=null,signal:f=null}=t;if(c)try{c.style?c.style.display="block":c.update&&c.update({style:{display:"block"}})}catch(e){console.warn("[DOM Helpers Async] Failed to show loading indicator:",e.message)}if(h&&"function"==typeof h)try{h()}catch(e){console.warn("[DOM Helpers Async] Error in onStart callback:",e.message)}const m={method:n,headers:{"Content-Type":"application/json",...s},signal:f};o&&(m.body="string"==typeof o?o:JSON.stringify(o));let y=null,g=0;for(;g<=a;)try{const t=new AbortController,n=setTimeout(()=>t.abort(),i),s=new AbortController;f&&f.addEventListener("abort",()=>s.abort()),t.signal.addEventListener("abort",()=>s.abort()),m.signal=s.signal;const r=await fetch(e,m);if(clearTimeout(n),!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const o=await r.json();if(c)try{c.style?c.style.display="none":c.update&&c.update({style:{display:"none"}})}catch(e){console.warn("[DOM Helpers Async] Failed to hide loading indicator:",e.message)}if(u&&"function"==typeof u)try{u(o,r)}catch(e){console.warn("[DOM Helpers Async] Error in onSuccess callback:",e.message)}if(p&&"function"==typeof p)try{p()}catch(e){console.warn("[DOM Helpers Async] Error in onFinally callback:",e.message)}return o}catch(e){y=e,g++,g<=a&&await r(l*g)}if(c)try{c.style?c.style.display="none":c.update&&c.update({style:{display:"none"}})}catch(e){console.warn("[DOM Helpers Async] Failed to hide loading indicator:",e.message)}if(d&&"function"==typeof d)try{d(y)}catch(e){console.warn("[DOM Helpers Async] Error in onError callback:",e.message)}if(p&&"function"==typeof p)try{p()}catch(e){console.warn("[DOM Helpers Async] Error in onFinally callback:",e.message)}throw y}async function i(e,t={}){return o(e,t)}async function a(e,t={}){return(await o(e,{...t,parseJSON:!1})).text()}async function l(e,t={}){return(await o(e,{...t,parseJSON:!1})).blob()}function c(e,t={}){const{errorHandler:n=null,loadingClass:s="loading",loadingAttribute:r="data-loading"}=t;return async function(t,...o){if("function"!=typeof e)return void console.error("[DOM Helpers Async] asyncHandler: handler must be a function");const i=t.target||t.currentTarget;try{i&&(s&&i.classList.add(s),r&&i.setAttribute(r,"true"))}catch(e){console.warn("[DOM Helpers Async] Failed to set loading state:",e.message)}try{return await e.call(this,t,...o)}catch(e){if(console.error("[DOM Helpers Async] Error in async handler:",e),n&&"function"==typeof n)try{n(e,t,...o)}catch(e){console.error("[DOM Helpers Async] Error in error handler:",e)}throw e}finally{try{i&&(s&&i.classList.remove(s),r&&i.removeAttribute(r))}catch(e){console.warn("[DOM Helpers Async] Failed to remove loading state:",e.message)}}}}function u(e,t={}){if(!e||!e.elements)return{isValid:!1,errors:["Invalid form element"]};const n=[];return Array.from(e.elements).forEach(e=>{const s=e.name;if(!s||!t[s])return;const r=t[s],o=e.value.trim();if(r.required&&!o)return n.push(`${r.label||s} is required`),void e.classList.add("error");if(o){if("email"!==r.type||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)||(n.push(`${r.label||s} must be a valid email`),e.classList.add("error")),"url"!==r.type||/^https?:\/\/.+/.test(o)||(n.push(`${r.label||s} must be a valid URL`),e.classList.add("error")),"number"===r.type&&isNaN(parseFloat(o))&&(n.push(`${r.label||s} must be a number`),e.classList.add("error")),r.minLength&&o.length<r.minLength&&(n.push(`${r.label||s} must be at least ${r.minLength} characters`),e.classList.add("error")),r.maxLength&&o.length>r.maxLength&&(n.push(`${r.label||s} must be no more than ${r.maxLength} characters`),e.classList.add("error")),r.pattern&&!r.pattern.test(o)&&(n.push(r.message||`${r.label||s} format is invalid`),e.classList.add("error")),r.validator&&"function"==typeof r.validator)try{const t=r.validator(o,e);!0!==t&&"string"==typeof t&&(n.push(t),e.classList.add("error"))}catch(e){console.warn("[DOM Helpers Async] Error in custom validator:",e.message)}n.some(e=>e.includes(r.label||s))||e.classList.remove("error")}}),{isValid:0===n.length,errors:n}}function d(e,t={}){if(!e||!e.elements)return{};const{includeEmpty:n=!1,transform:s=null,excludeDisabled:r=!0}=t,o={},i=new FormData(e);for(const[t,s]of i.entries()){const i=e.elements[t];r&&i&&i.disabled||(n||s&&""!==s.toString().trim())&&(o.hasOwnProperty(t)?Array.isArray(o[t])?o[t].push(s):o[t]=[o[t],s]:o[t]=s)}if(s&&"function"==typeof s)try{return s(o)}catch(e){return console.warn("[DOM Helpers Async] Error in form data transformation:",e.message),o}return o}function h(e,t,n="info",s={}){const{duration:r=5e3,className:o="form-message",container:i=null}=s;let a=i||e.querySelector(`.${o}`);return a?a.className=`${o} ${o}--${n}`:(a=document.createElement("div"),a.className=`${o} ${o}--${n}`,e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a)),a.textContent=t,a.style.display="block",r>0&&setTimeout(()=>{a&&a.parentNode&&(a.style.display="none")},r),a}async function p(e,t={}){const{onProgress:n=null,failFast:s=!0}=t;if(!Array.isArray(e))throw new Error("[DOM Helpers Async] parallelAll: promises must be an array");if(s)return Promise.all(e);const r=[];let o=0;for(let t=0;t<e.length;t++){try{const n=await e[t];r[t]={status:"fulfilled",value:n}}catch(e){r[t]={status:"rejected",reason:e}}if(o++,n&&"function"==typeof n)try{n(o,e.length,r[t])}catch(e){console.warn("[DOM Helpers Async] Error in progress callback:",e.message)}}return r}async function f(e,t=5e3){const n=new Promise((e,n)=>{setTimeout(()=>n(new Error("Operation timed out")),t)});return Promise.race([...e,n])}function m(){if(void 0!==e){if(e.AsyncHelpers={debounce:t,throttle:n,sanitize:s,sleep:r,fetch:o,fetchJSON:i,fetchText:a,fetchBlob:l,asyncHandler:c,validateForm:u,getFormData:d,showFormMessage:h,parallelAll:p,raceWithTimeout:f},e.Elements&&(Object.assign(e.Elements,{debounce:t,throttle:n,sanitize:s,sleep:r,fetch:o,fetchJSON:i,fetchText:a,fetchBlob:l,asyncHandler:c,validateForm:(e,t)=>u(e,t),getFormData:(e,t)=>d(e,t),showFormMessage:(e,t,n,s)=>h(e,t,n,s),parallelAll:p,raceWithTimeout:f}),e.Elements.helper&&e.Elements.helper._enhanceElementWithUpdate)){const t=e.Elements.helper._enhanceElementWithUpdate;e.Elements.helper._enhanceElementWithUpdate=function(e){const n=t.call(this,e);return n&&"FORM"===n.tagName&&(n.validate=function(e){return u(this,e)},n.getData=function(e){return d(this,e)},n.showMessage=function(e,t,n){return h(this,e,t,n)},n.submitAsync=function(e={}){const{validate:t=!0,validationRules:s={},onSuccess:r=null,onError:i=null,...a}=e;return c(async e=>{if(e.preventDefault(),t){const e=this.validate(s);if(!e.isValid){const t=e.errors.join(", ");return void this.showMessage(t,"error")}}const n=this.getData();return await o(this.action||window.location.href,{method:this.method||"POST",body:n,onSuccess:r,onError:i,...a})}).call(n)}),n}}e.Collections&&Object.assign(e.Collections,{debounce:t,throttle:n,sanitize:s,sleep:r,fetch:o,fetchJSON:i,fetchText:a,fetchBlob:l,asyncHandler:c,parallelAll:p,raceWithTimeout:f}),e.Selector&&Object.assign(e.Selector,{debounce:t,throttle:n,sanitize:s,sleep:r,fetch:o,fetchJSON:i,fetchText:a,fetchBlob:l,asyncHandler:c,parallelAll:p,raceWithTimeout:f})}}const y={debounce:t,throttle:n,sanitize:s,sleep:r,fetch:o,fetchJSON:i,fetchText:a,fetchBlob:l,asyncHandler:c,validateForm:u,getFormData:d,showFormMessage:h,parallelAll:p,raceWithTimeout:f,integrate:m,configure:(e={})=>{const{debounceDelay:t=300,throttleDelay:n=200,fetchTimeout:s=1e4,fetchRetries:r=0}=e;return y.config={debounceDelay:t,throttleDelay:n,fetchTimeout:s,fetchRetries:r},y},version:"1.0.0",isDOMHelpersAvailable:()=>!!(e.Elements||e.Collections||e.Selector)};"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(m,100)}):setTimeout(m,100)),m(),setTimeout(()=>{"undefined"!=typeof console&&y.isDOMHelpersAvailable()&&console.log("[DOM Helpers Async] Successfully integrated with DOM Helpers ecosystem")},200),"undefined"!=typeof module&&module.exports?module.exports=y:"function"==typeof define&&define.amd?define([],function(){return y}):(e.AsyncHelpers=y,e.debounce=t,e.throttle=n,e.sanitize=s)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);